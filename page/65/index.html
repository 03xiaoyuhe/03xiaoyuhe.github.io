<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
<link rel="stylesheet" href="/css/custom.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="O3xiaoyuhe">
<meta property="og:url" content="http://example.com/page/65/index.html">
<meta property="og:site_name" content="O3xiaoyuhe">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="听">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/65/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>O3xiaoyuhe</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">O3xiaoyuhe</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%92%8C%20JavaScript%20%E4%BA%A4%E4%BA%92%EF%BC%88asp.net%20%E5%89%8D%E5%8F%B0%E5%92%8C%E5%90%8E%E5%8F%B0%E4%BA%92%E8%B0%83%EF%BC%89_c#%20%E7%BD%91%E9%A1%B5%E9%97%B4%20js%20%E4%BA%92%E8%B0%83%E7%94%A8%20-%20CSDN%20%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%92%8C%20JavaScript%20%E4%BA%A4%E4%BA%92%EF%BC%88asp.net%20%E5%89%8D%E5%8F%B0%E5%92%8C%E5%90%8E%E5%8F%B0%E4%BA%92%E8%B0%83%EF%BC%89_c#%20%E7%BD%91%E9%A1%B5%E9%97%B4%20js%20%E4%BA%92%E8%B0%83%E7%94%A8%20-%20CSDN%20%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 18:45:33" itemprop="dateModified" datetime="2024-11-13T18:45:33+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>本文由 <a target="_blank" rel="noopener" href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a target="_blank" rel="noopener" href="https://blog.csdn.net/u014180504/article/details/70770130">blog.csdn.net</a></p>
</blockquote>
<p>C# 代码与 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=javaScript&amp;spm=1001.2101.3001.7020">javaScript</a> 函数的相互调用：</p>
<ol>
<li class="lvl-3">
<p>如何在 JavaScript 访问 C# 函数?</p>
</li>
<li class="lvl-3">
<p>如何在 JavaScript 访问 C# 变量?</p>
</li>
<li class="lvl-3">
<p>如何在 C# 中访问 JavaScript 的已有变量?</p>
</li>
<li class="lvl-3">
<p>如何在 C# 中访问 JavaScript 函数?</p>
</li>
</ol>
<p>问题 1 答案如下：</p>
<p>javaScript 函数中执行 C# 代码中的函数：</p>
<p>方法一：页面和页面类相结合</p>
<p>1、函数声明为 public</p>
<p>后台代码 (把 public 改成 protected 也可以)</p>
<p>public string ss()</p>
<p>{</p>
<p>return(“a”);</p>
<p>}</p>
<p>2、在 html 里用 &lt;%=ss()%&gt; 可以调用 // 是 C# 中后台的函数名称</p>
<p>前台脚本</p>
<p><script language=javascript></p>
<p>var a = “&lt;%=ss()%&gt;”;//JavaScript 中调用 C# 后台的函数</p>
<p>alert(a);</p>
<p></script></p>
<p>方法二： JavaScript 异步调用定义在 <a target="_blank" rel="noopener" href="http://ASP.Net">ASP.Net</a> 页面中的方法   <br>
            1. 将该方法声明为公有 (public);   <br>
            2. 将该方法声明为类方法 (C# 中的 static,<a target="_blank" rel="noopener" href="http://VB.NET">VB.NET</a> 中的 Shared), 而不是实例方法;   <br>
            3. 将该方法添加【WebMethod】属性   <br>
            4. 将页面中 ScriptManager 控件的 EnablePageMethods 属性设置为 true;   <br>
            5. 在客户端使用如下 JavaScript 语法调用该页面方法   <br>
                PageMethods.<a href="param1,param2,...,callbackFunction">MethodName</a>;   <br>
            6. 为客户端异步调用指定回调函数, 在回调函数中接受返回值并进一步处理;   <br>
            7. 添加 using System.Web.Services;</p>
<p>示例：</p>
<p>前台 JavaScript 代码</p>
<html xmlns="[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)">  
<head runat="server">  
    <title> 无标题页 </title>
<p><script type="text/javascript"><br>
    function JsCallCSharp(param1)<br>
    {            <br>
      PageMethods.sayhell(param1,onSayHelloSucceeded);//sayhell 是后台标注了【webMethod】属性的方法 param1 是传入该方法的参数，onSayHelloSucceeded 是回调函数主要是对后台返回的结果进一步处理<br>
    }        <br>
    function onSayHelloSucceeded(result)// 绑定的回调函数 <br>
    { <br>
    alert(result);<br>
    }</p>
<p></script></p>
</head>  
<body>  
    <form runat="server">  
    <asp:ScriptManager runat="server" EnablePageMethods="true">//ScriptManager 控件管理脚本的，
<p>注意设置 EnablePageMethods=“true” 此属性<br>
    &lt;/asp:ScriptManager&gt;<br>
    <div><br>
        &lt;input type=“button” οnclick=“JsCallCSharp(‘hello’)” /&gt;<br>
    </div><br>
    </form></p>
</body>  
</html>  
 后台代码（.cs 文件）  
using System;  
using System.Configuration;  
using System.Data;  
using System.Linq;  
using System.Web;  
using System.Web.Security;  
using System.Web.UI;  
using System.Web.UI.HtmlControls;  
using System.Web.UI.WebControls;  
using System.Web.UI.WebControls.WebParts;  
using System.Xml.Linq;  
using System.Web.Services;// 添加 web 服务引用
<p>public partial class _Default : System.Web.UI.Page<br>
{<br>
    protected void Page_Load(object sender, EventArgs e)<br>
    {</p>
<p>}<br>
    [WebMethod]// 标示为 web 服务方法属性<br>
    public static  string sayhell(string say)// 注意函数的修饰符, 只能是静态的<br>
    {<br>
        return say;<br>
    }<br>
}</p>
<p>方法三： JavaScript 异步调用定义在 Web 服务类中的方法</p>
<ol>
<li class="lvl-3">
<p>添加一个 web 服务标示该服务为 允许使用 <a target="_blank" rel="noopener" href="http://ASP.NET">ASP.NET</a> AJAX 从脚本中调用此 Web 服务</p>
</li>
</ol>
<p>对应属性为 [System.Web.Script.Services.ScriptService]</p>
<ol start="2">
<li class="lvl-3">
<p>将该方法声明 public 并将该方法标示为 [webMethod] 属性方法</p>
</li>
<li class="lvl-3">
<p>在页面中 ScriptManager 控件并添加 web 服务引用 <Services>&lt;asp:ServiceReference Path=“~/WebService.asmx” /&gt;</Services></p>
</li>
<li class="lvl-3">
<p>在客户端使用如下 JavaScript 语法调用 web 服务方法</p>
</li>
</ol>
<p>WebService.HelloWorld(“helloWord”,function(res)//Webservice 是 web 服务页面名称 HelloWord 为 web 服务页面类中的方法，function 为回调 JavaScript 函数主要是处理返回的结果<br>
     {<br>
     alert(res);<br>
     });</p>
<p>示例：</p>
<p>页面代码</p>
<html xmlns="[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)">  
<head runat="server">  
    <title> 无标题页 </title>
<p><script type="text/javascript"><br>
    function JsCallCSharp(param1)<br>
    {            <br>
      PageMethods.sayhell(param1,onSayHelloSucceeded);<br>
    }        <br>
    function onSayHelloSucceeded(result)<br>
    { <br>
    alert(result);<br>
    }</p>
<p>// 该方法为调用的函数<br>
    function JsCallWebService()<br>
    {<br>
     WebService.HelloWorld(“helloWord”,function(res)// 调用 web 服务<br>
     {<br>
     alert(res);<br>
     });<br>
    }<br>
    </script></p>
</head>  
<body>  
    <form runat="server">  
    <asp:ScriptManager runat="server" EnablePageMethods="true">  
   <Services><asp:ServiceReference Path="~/WebService.asmx" /></Services>// 注意要引用 web 服务  
    </asp:ScriptManager>  
    <div>  
        <input type="button" οnclick="JsCallCSharp('hello')" value="测试 C# 后台页" />  
        <input type="button" οnclick="JsCallWebService()" value="测试 web 后台类" />  
    </div>  
    </form>  
</body>  
</html>
<p>web 服务后台代码</p>
<p>using System;<br>
using System.Collections;<br>
using System.Linq;<br>
using <a target="_blank" rel="noopener" href="http://System.Web">System.Web</a>;<br>
using System.Web.Services;<br>
using System.Web.Services.Protocols;<br>
using System.Xml.Linq;</p>
<p>/// <summary><br>
///WebService 的摘要说明<br>
/// </summary><br>
[WebService(Namespace = “<a target="_blank" rel="noopener" href="http://tempuri.org/">http://tempuri.org/</a>”)]<br>
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]<br>
// 若要允许使用 <a target="_blank" rel="noopener" href="http://ASP.NET">ASP.NET</a> AJAX 从脚本中调用此 Web 服务，请取消对下行的注释。 <br>
 [System.Web.Script.Services.ScriptService]// 注意要添加该标示<br>
public class WebService : System.Web.Services.WebService {</p>
<p>public WebService () {</p>
<p>// 如果使用设计的组件，请取消注释以下行 <br>
        //InitializeComponent(); <br>
    }</p>
<p>[WebMethod]// 方法要标示的属性<br>
    public string HelloWorld(string result) {<br>
        return result;<br>
    }<br>
    <br>
}</p>
<p>问题 2 答案如下： 如何在 JavaScript 访问 C# 变量</p>
<p>方法一：1、通过页面上隐藏域访问 <input type="hidden" runat="server"></p>
<p>方法二：1、如后台定义了 PUBLIC STRING N; 前台 js 中引用该变量的格式为’&lt;%=n%&gt;'或 “+&lt;%=n%&gt;+”</p>
<p>方法三：1、或者你可以在服务器端变量赋值后在页面注册一段脚本</p>
<p>“<script language='javascript'>var temp=” + tmp + “</script>”</p>
<p>tmp 是后台变量，然后 js 中可以直接访问 temp 获得值。</p>
<p>问题 3 . 如何在 C# 中访问 JavaScript 的已有变量?</p>
<p>方法一：1、前台使用服务器文本控件隐藏域，将 js 变量值写入其中；后台直接通过控件 id 访问和调用</p>
<p>方法二：可以用 cookie 或 session 存储变量值，后台直接使用</p>
<p>问题 4 C# 代码执行 JavaScript 函数和调用 JavaScript 函数</p>
<p>方法一： . 尽量少用 Response.Write(<script>&lt; /script&gt;); 这种方法, 它会影响 CSS 导致页面效果偏差</p>
<p>方法二：C# 中使用 ScriptManager.RegisterStartupScript(this, this.GetType(), “edit”, “CSharpCallJs('”+param1+“‘,’”+param2+“')”,</p>
<p>示例：</p>
<p>脚本函数</p>
<p>function CSharpCallJs(param1,param2)   <br>
        {   <br>
            alert(param1 + param2);   <br>
        }</p>
<p>页面后台代码</p>
<p>ScriptManager.RegisterStartupScript(this, this.GetType(), “edit”, “CSharpCallJs('” + param1 + “‘,’” + param2 + “');”, true);// 关键代码调用页面脚本函数的代码</p>
<p>方法三：C# 中使用 Page.RegisterStartupScript(“ggg”,“<script>CSharpCallJs“”+param1+“,”+param2+“);“</script>”);</p>
<p>方法四：C# 中使用 Literal 类（类似 label 类）</p>
<p>示例代码</p>
<p>private void Button2_Click(object sender, System.EventArgs e)</p>
<p>{</p>
<p>string str;</p>
<p>str=“<script language='javascript'>”;</p>
<p>str+=“selectRange()”;</p>
<p>str+=“</script>”;</p>
<p><a target="_blank" rel="noopener" href="//Literal1.Visible=true">//Literal1.Visible=true</a>;</p>
<p>Literal1.Text=str;</p>
<p>｝</p>
<p>以上是自己工作中的总结，主要是总结了 JavaScript 和后台的交互以及 <a target="_blank" rel="noopener" href="http://asp.net">asp.net</a> 中前台和后台的交互。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%88%A4%E6%96%AD%E5%90%84%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%A6%82%E6%89%8B%E6%9C%BA%E5%8F%B7)_c#%20%E5%88%A4%20%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%98%AF%E4%B8%8D%E6%98%AF%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81%20-%20CSDN%20%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%88%A4%E6%96%AD%E5%90%84%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%A6%82%E6%89%8B%E6%9C%BA%E5%8F%B7)_c#%20%E5%88%A4%20%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%98%AF%E4%B8%8D%E6%98%AF%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81%20-%20CSDN%20%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 18:45:56" itemprop="dateModified" datetime="2024-11-13T18:45:56+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>本文由 <a target="_blank" rel="noopener" href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a target="_blank" rel="noopener" href="https://blog.csdn.net/chinaplan/article/details/8848832">blog.csdn.net</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"> using System.Text.RegularExpressions;</span><br><span class="line"> namespace MetarCommonSupport</span><br><span class="line"> &#123;</span><br><span class="line">     /// &lt;summary&gt;</span><br><span class="line">     /// 通过Framwork类库中的Regex类实现了一些特殊功能数据检查</span><br><span class="line">     /// &lt;/summary&gt;</span><br><span class="line">     public class MetarnetRegex</span><br><span class="line">     &#123;</span><br><span class="line"> </span><br><span class="line">         private static MetarnetRegex instance = null;</span><br><span class="line">         public static MetarnetRegex GetInstance()</span><br><span class="line">         &#123;</span><br><span class="line">             if (MetarnetRegex.instance == null)</span><br><span class="line">             &#123;</span><br><span class="line">                 MetarnetRegex.instance = new MetarnetRegex();</span><br><span class="line">             &#125;</span><br><span class="line">             return MetarnetRegex.instance;</span><br><span class="line">         &#125;</span><br><span class="line">         private MetarnetRegex()</span><br><span class="line">         &#123;</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串只包含汉字</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsChineseCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[\u4e00-\u9fa5]+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配3位或4位区号的电话号码，其中区号可以用小括号括起来，</span><br><span class="line">         /// 也可以不用，区号与本地号间可以用连字号或空格间隔，</span><br><span class="line">         /// 也可以没有间隔</span><br><span class="line">         /// \(0\d&#123;2&#125;\)[- ]?\d&#123;8&#125;|0\d&#123;2&#125;[- ]?\d&#123;8&#125;|\(0\d&#123;3&#125;\)[- ]?\d&#123;7&#125;|0\d&#123;3&#125;[- ]?\d&#123;7&#125;</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsPhone(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;^\\(0\\d&#123;2&#125;\\)[- ]?\\d&#123;8&#125;$|^0\\d&#123;2&#125;[- ]?\\d&#123;8&#125;$|^\\(0\\d&#123;3&#125;\\)[- ]?\\d&#123;7&#125;$|^0\\d&#123;3&#125;[- ]?\\d&#123;7&#125;$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个合法的手机号</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsMobilePhone(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^13\\d&#123;9&#125;$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串只包含数字</span><br><span class="line">         /// 可以匹配整数和浮点数</span><br><span class="line">         /// ^-?\d+$|^(-?\d+)(\.\d+)?$</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNumber(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;^-?\\d+$|^(-?\\d+)(\\.\\d+)?$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配非负整数</span><br><span class="line">         ///</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNotNagtive(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(@&quot;^\d+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配正整数</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsUint(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[0-9]*[1-9][0-9]*$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串字包含英文字母</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsEnglisCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[A-Za-z]+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个合法的Email地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsEmail(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = @&quot;^([\w-\.]+)@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.)|(([\w-]+\.)+))([a-zA-Z]&#123;2,4&#125;|[0-9]&#123;1,3&#125;)(\]?)$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否只包含数字和英文字母</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNumAndEnCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = @&quot;^[A-Za-z0-9]+$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个超链接</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsURL(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             //string pattern = @&quot;http://([\w-]+\.)+[\w-]+(/[\w- ./?%&amp;=]*)?&quot;;</span><br><span class="line">             string pattern = @&quot;^[a-zA-Z]+://(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\S*)?$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是表示一个IP地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;被比较的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;是IP地址则为True&lt;/returns&gt;</span><br><span class="line">         public static bool IsIPv4(string input)</span><br><span class="line">         &#123;</span><br><span class="line"> </span><br><span class="line">             string[] IPs = input.Split(&#x27;.&#x27;);</span><br><span class="line">             Regex regex = new Regex(@&quot;^\d+$&quot;);</span><br><span class="line">             for (int i = 0; i &lt; IPs.Length; i++)</span><br><span class="line">             &#123;</span><br><span class="line">                 if (!regex.IsMatch(IPs[i]))</span><br><span class="line">                 &#123;</span><br><span class="line">                     return false;</span><br><span class="line">                 &#125;</span><br><span class="line">                 if (Convert.ToUInt16(IPs[i]) &gt; 255)</span><br><span class="line">                 &#123;</span><br><span class="line">                     return false;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             return true;</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 计算字符串的字符长度，一个汉字字符将被计算为两个字符</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;需要计算的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;返回字符串的长度&lt;/returns&gt;</span><br><span class="line">         public static int GetCount(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             return Regex.Replace(input, @&quot;[\u4e00-\u9fa5/g]&quot;, &quot;aa&quot;).Length;</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 调用Regex中IsMatch函数实现一般的正则表达式匹配</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;要匹配的正则表达式模式。&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;要搜索匹配项的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;如果正则表达式找到匹配项，则为 true；否则，为 false。&lt;/returns&gt;</span><br><span class="line">         public static bool IsMatch(string pattern, string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 从输入字符串中的第一个字符开始，用替换字符串替换指定的正则表达式模式的所有匹配项。</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;模式字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;输入字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;用于替换的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;返回被替换后的结果&lt;/returns&gt;</span><br><span class="line">         public static string Replace(string pattern, string input, string replacement)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.Replace(input, replacement);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 在由正则表达式模式定义的位置拆分输入字符串。</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;模式字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;输入字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static string[] Split(string pattern, string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.Split(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是合法的IPV6 地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsIPV6(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;&quot;;</span><br><span class="line">             string temp = input;</span><br><span class="line">             string[] strs = temp.Split(&#x27;:&#x27;);</span><br><span class="line">             if (strs.Length &gt; 8)</span><br><span class="line">             &#123;</span><br><span class="line">                 return false;</span><br><span class="line">             &#125;</span><br><span class="line">             int count = MetarnetRegex.GetStringCount(input, &quot;::&quot;);</span><br><span class="line">             if (count &gt; 1)</span><br><span class="line">             &#123;</span><br><span class="line">                 return false;</span><br><span class="line">             &#125;</span><br><span class="line">             else if (count == 0)</span><br><span class="line">             &#123;</span><br><span class="line">                 pattern = @&quot;^([\da-f]&#123;1,4&#125;:)&#123;7&#125;[\da-f]&#123;1,4&#125;$&quot;;</span><br><span class="line"> </span><br><span class="line">                 Regex regex = new Regex(pattern);</span><br><span class="line">                 return regex.IsMatch(input);</span><br><span class="line">             &#125;</span><br><span class="line">             else</span><br><span class="line">             &#123;</span><br><span class="line">                 pattern = @&quot;^([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;::([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;[\da-f]&#123;1,4&#125;$&quot;;</span><br><span class="line">                 Regex regex1 = new Regex(pattern);</span><br><span class="line">                 return regex1.IsMatch(input);</span><br><span class="line">             &#125;</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line">         /* *******************************************************************</span><br><span class="line">         * 1、通过“:”来分割字符串看得到的字符串数组长度是否小于等于8</span><br><span class="line">         * 2、判断输入的IPV6字符串中是否有“::”。</span><br><span class="line">         * 3、如果没有“::”采用 ^([\da-f]&#123;1,4&#125;:)&#123;7&#125;[\da-f]&#123;1,4&#125;$ 来判断</span><br><span class="line">         * 4、如果有“::” ，判断&quot;::&quot;是否止出现一次</span><br><span class="line">         * 5、如果出现一次以上 返回false</span><br><span class="line">         * 6、^([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;::([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;[\da-f]&#123;1,4&#125;$</span><br><span class="line">         * ******************************************************************/</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断字符串compare 在 input字符串中出现的次数</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;源字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;用于比较的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;字符串compare 在 input字符串中出现的次数&lt;/returns&gt;</span><br><span class="line">         private static int GetStringCount(string input, string compare)</span><br><span class="line">         &#123;</span><br><span class="line">             int index = input.IndexOf(compare);</span><br><span class="line">             if (index != -1)</span><br><span class="line">             &#123;</span><br><span class="line">                 return 1 + GetStringCount(input.Substring(index + compare.Length), compare);</span><br><span class="line">             &#125;</span><br><span class="line">             else</span><br><span class="line">             &#123;</span><br><span class="line">                 return 0;</span><br><span class="line">             &#125;</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%88%A4%E6%96%AD%E5%90%84%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%A6%82%E6%89%8B%E6%9C%BA%E5%8F%B7)_c#%20%E5%88%A4%20%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%98%AF%E4%B8%8D%E6%98%AF%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81%20-%20CSDN%20%E5%8D%9A%E5%AE%A2%20(1)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/simpread-C#%20%E5%88%A4%E6%96%AD%E5%90%84%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E5%A6%82%E6%89%8B%E6%9C%BA%E5%8F%B7)_c#%20%E5%88%A4%20%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%98%AF%E4%B8%8D%E6%98%AF%E6%89%8B%E6%9C%BA%E5%8F%B7%E7%A0%81%20-%20CSDN%20%E5%8D%9A%E5%AE%A2%20(1)/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 18:45:53" itemprop="dateModified" datetime="2024-11-13T18:45:53+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>本文由 <a target="_blank" rel="noopener" href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a target="_blank" rel="noopener" href="https://blog.csdn.net/chinaplan/article/details/8848832">blog.csdn.net</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"> using System.Text.RegularExpressions;</span><br><span class="line"> namespace MetarCommonSupport</span><br><span class="line"> &#123;</span><br><span class="line">     /// &lt;summary&gt;</span><br><span class="line">     /// 通过Framwork类库中的Regex类实现了一些特殊功能数据检查</span><br><span class="line">     /// &lt;/summary&gt;</span><br><span class="line">     public class MetarnetRegex</span><br><span class="line">     &#123;</span><br><span class="line"> </span><br><span class="line">         private static MetarnetRegex instance = null;</span><br><span class="line">         public static MetarnetRegex GetInstance()</span><br><span class="line">         &#123;</span><br><span class="line">             if (MetarnetRegex.instance == null)</span><br><span class="line">             &#123;</span><br><span class="line">                 MetarnetRegex.instance = new MetarnetRegex();</span><br><span class="line">             &#125;</span><br><span class="line">             return MetarnetRegex.instance;</span><br><span class="line">         &#125;</span><br><span class="line">         private MetarnetRegex()</span><br><span class="line">         &#123;</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串只包含汉字</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsChineseCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[\u4e00-\u9fa5]+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配3位或4位区号的电话号码，其中区号可以用小括号括起来，</span><br><span class="line">         /// 也可以不用，区号与本地号间可以用连字号或空格间隔，</span><br><span class="line">         /// 也可以没有间隔</span><br><span class="line">         /// \(0\d&#123;2&#125;\)[- ]?\d&#123;8&#125;|0\d&#123;2&#125;[- ]?\d&#123;8&#125;|\(0\d&#123;3&#125;\)[- ]?\d&#123;7&#125;|0\d&#123;3&#125;[- ]?\d&#123;7&#125;</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsPhone(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;^\\(0\\d&#123;2&#125;\\)[- ]?\\d&#123;8&#125;$|^0\\d&#123;2&#125;[- ]?\\d&#123;8&#125;$|^\\(0\\d&#123;3&#125;\\)[- ]?\\d&#123;7&#125;$|^0\\d&#123;3&#125;[- ]?\\d&#123;7&#125;$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个合法的手机号</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsMobilePhone(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^13\\d&#123;9&#125;$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串只包含数字</span><br><span class="line">         /// 可以匹配整数和浮点数</span><br><span class="line">         /// ^-?\d+$|^(-?\d+)(\.\d+)?$</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNumber(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;^-?\\d+$|^(-?\\d+)(\\.\\d+)?$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配非负整数</span><br><span class="line">         ///</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNotNagtive(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(@&quot;^\d+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 匹配正整数</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsUint(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[0-9]*[1-9][0-9]*$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串字包含英文字母</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsEnglisCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(&quot;^[A-Za-z]+$&quot;);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个合法的Email地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsEmail(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = @&quot;^([\w-\.]+)@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.)|(([\w-]+\.)+))([a-zA-Z]&#123;2,4&#125;|[0-9]&#123;1,3&#125;)(\]?)$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否只包含数字和英文字母</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsNumAndEnCh(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = @&quot;^[A-Za-z0-9]+$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是一个超链接</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsURL(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             //string pattern = @&quot;http://([\w-]+\.)+[\w-]+(/[\w- ./?%&amp;=]*)?&quot;;</span><br><span class="line">             string pattern = @&quot;^[a-zA-Z]+://(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\S*)?$&quot;;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是表示一个IP地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;被比较的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;是IP地址则为True&lt;/returns&gt;</span><br><span class="line">         public static bool IsIPv4(string input)</span><br><span class="line">         &#123;</span><br><span class="line"> </span><br><span class="line">             string[] IPs = input.Split(&#x27;.&#x27;);</span><br><span class="line">             Regex regex = new Regex(@&quot;^\d+$&quot;);</span><br><span class="line">             for (int i = 0; i &lt; IPs.Length; i++)</span><br><span class="line">             &#123;</span><br><span class="line">                 if (!regex.IsMatch(IPs[i]))</span><br><span class="line">                 &#123;</span><br><span class="line">                     return false;</span><br><span class="line">                 &#125;</span><br><span class="line">                 if (Convert.ToUInt16(IPs[i]) &gt; 255)</span><br><span class="line">                 &#123;</span><br><span class="line">                     return false;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             return true;</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 计算字符串的字符长度，一个汉字字符将被计算为两个字符</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;需要计算的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;返回字符串的长度&lt;/returns&gt;</span><br><span class="line">         public static int GetCount(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             return Regex.Replace(input, @&quot;[\u4e00-\u9fa5/g]&quot;, &quot;aa&quot;).Length;</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 调用Regex中IsMatch函数实现一般的正则表达式匹配</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;要匹配的正则表达式模式。&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;要搜索匹配项的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;如果正则表达式找到匹配项，则为 true；否则，为 false。&lt;/returns&gt;</span><br><span class="line">         public static bool IsMatch(string pattern, string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.IsMatch(input);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 从输入字符串中的第一个字符开始，用替换字符串替换指定的正则表达式模式的所有匹配项。</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;模式字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;输入字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;用于替换的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;返回被替换后的结果&lt;/returns&gt;</span><br><span class="line">         public static string Replace(string pattern, string input, string replacement)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.Replace(input, replacement);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 在由正则表达式模式定义的位置拆分输入字符串。</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;模式字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;输入字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static string[] Split(string pattern, string input)</span><br><span class="line">         &#123;</span><br><span class="line">             Regex regex = new Regex(pattern);</span><br><span class="line">             return regex.Split(input);</span><br><span class="line">         &#125;</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断输入的字符串是否是合法的IPV6 地址</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">         public static bool IsIPV6(string input)</span><br><span class="line">         &#123;</span><br><span class="line">             string pattern = &quot;&quot;;</span><br><span class="line">             string temp = input;</span><br><span class="line">             string[] strs = temp.Split(&#x27;:&#x27;);</span><br><span class="line">             if (strs.Length &gt; 8)</span><br><span class="line">             &#123;</span><br><span class="line">                 return false;</span><br><span class="line">             &#125;</span><br><span class="line">             int count = MetarnetRegex.GetStringCount(input, &quot;::&quot;);</span><br><span class="line">             if (count &gt; 1)</span><br><span class="line">             &#123;</span><br><span class="line">                 return false;</span><br><span class="line">             &#125;</span><br><span class="line">             else if (count == 0)</span><br><span class="line">             &#123;</span><br><span class="line">                 pattern = @&quot;^([\da-f]&#123;1,4&#125;:)&#123;7&#125;[\da-f]&#123;1,4&#125;$&quot;;</span><br><span class="line"> </span><br><span class="line">                 Regex regex = new Regex(pattern);</span><br><span class="line">                 return regex.IsMatch(input);</span><br><span class="line">             &#125;</span><br><span class="line">             else</span><br><span class="line">             &#123;</span><br><span class="line">                 pattern = @&quot;^([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;::([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;[\da-f]&#123;1,4&#125;$&quot;;</span><br><span class="line">                 Regex regex1 = new Regex(pattern);</span><br><span class="line">                 return regex1.IsMatch(input);</span><br><span class="line">             &#125;</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line">         /* *******************************************************************</span><br><span class="line">         * 1、通过“:”来分割字符串看得到的字符串数组长度是否小于等于8</span><br><span class="line">         * 2、判断输入的IPV6字符串中是否有“::”。</span><br><span class="line">         * 3、如果没有“::”采用 ^([\da-f]&#123;1,4&#125;:)&#123;7&#125;[\da-f]&#123;1,4&#125;$ 来判断</span><br><span class="line">         * 4、如果有“::” ，判断&quot;::&quot;是否止出现一次</span><br><span class="line">         * 5、如果出现一次以上 返回false</span><br><span class="line">         * 6、^([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;::([\da-f]&#123;1,4&#125;:)&#123;0,5&#125;[\da-f]&#123;1,4&#125;$</span><br><span class="line">         * ******************************************************************/</span><br><span class="line">         /// &lt;summary&gt;</span><br><span class="line">         /// 判断字符串compare 在 input字符串中出现的次数</span><br><span class="line">         /// &lt;/summary&gt;</span><br><span class="line">         /// &lt;param &gt;源字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;param &gt;用于比较的字符串&lt;/param&gt;</span><br><span class="line">         /// &lt;returns&gt;字符串compare 在 input字符串中出现的次数&lt;/returns&gt;</span><br><span class="line">         private static int GetStringCount(string input, string compare)</span><br><span class="line">         &#123;</span><br><span class="line">             int index = input.IndexOf(compare);</span><br><span class="line">             if (index != -1)</span><br><span class="line">             &#123;</span><br><span class="line">                 return 1 + GetStringCount(input.Substring(index + compare.Length), compare);</span><br><span class="line">             &#125;</span><br><span class="line">             else</span><br><span class="line">             &#123;</span><br><span class="line">                 return 0;</span><br><span class="line">             &#125;</span><br><span class="line"> </span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/CAMEL%EF%BC%9A%E9%80%9A%E8%BF%87%E8%A7%92%E8%89%B2%E6%89%AE%E6%BC%94%E8%84%91%E6%9A%B4%E4%B8%80%E4%B8%AA%E9%B2%9C%E8%8A%B1%E8%90%A5%E9%94%80%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/CAMEL%EF%BC%9A%E9%80%9A%E8%BF%87%E8%A7%92%E8%89%B2%E6%89%AE%E6%BC%94%E8%84%91%E6%9A%B4%E4%B8%80%E4%B8%AA%E9%B2%9C%E8%8A%B1%E8%90%A5%E9%94%80%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-18 19:28:25" itemprop="dateModified" datetime="2024-11-18T19:28:25+08:00">2024-11-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>你好，我是黄佳，欢迎来到 LangChain 实战课！</p>
<p>大模型的成功，在很大程度上依赖于用户的输入来引导对话生成。如果用户能够详细描述他们的任务和需求，并与 ChatGPT 建立一个连贯的聊天上下文，那么 ChatGPT 往往能提供更精确和高质量的答案。但是，为模型提供这种引导是一项既费时又费力的任务。</p>
<p>这就引出了一个有趣的问题：<strong>能否让 ChatGPT 自己生成这些引导文本呢？</strong></p>
<p>基于这个想法，KAUST（阿卜杜拉国王大学）的研究团队提出了一个名为 CAMEL 的框架。CAMEL 采用了一种基于 “角色扮演” 方式的大模型交互策略。在这种策略中，不同的 AI 代理扮演不同的角色，通过互相交流来完成任务。</p>
<h2 id="CAMEL-交流式代理框架">CAMEL 交流式代理框架</h2>
<p>下面我们一起来看看 CAMEL——这个多 AI 通过角色扮演进行交互的框架，以及它在 LangChain 中的具体实现。</p>
<p><img src="https://static001.geekbang.org/resource/image/57/c3/578c7a5a91ffe7007c0fe4cea3d20bc3.png?wh=694x290" alt=""></p>
<p>CAMEL，字面意思是骆驼。这个框架来自于论文《<a href="https://link.juejin.cn/?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2303.17760.pdf" title="https://arxiv.org/pdf/2303.17760.pdf">CAMEL: Communicative Agents for “Mind” Exploration of Large Scale Language Model Society</a>》（CAMEL：用于大规模语言模型社会的 “心智” 探索的交流式代理）。这里面所谓的 CAMEL，实际上来自<strong>沟通（也就是交流）</strong>、<strong>代理</strong>、<strong>心智</strong>、<strong>探索</strong>以及 <strong>LLM</strong> 这五个单词的英文首字母。</p>
<p>CAMEL 框架旨在通过角色扮演来促进交流代理之间的自主合作，并为其 “认知” 过程提供洞察。这种方法涉及使用启示式提示来指导聊天代理完成任务，同时保持与人类意图的一致性。这个框架为研究多代理系统的合作行为和能力提供了一种可扩展的方法。</p>
<p>上面这段介绍里面新名词不少，我们要一个个解释一下。</p>
<ul class="lvl-0">
<li class="lvl-4">
<p><strong>交流式代理</strong> Communicative Agents，是一种可以与人类或其他代理进行交流的计算机程序。这些代理可以是聊天机器人、智能助手或任何其他需要与人类交流的软件。为了使这些代理能够更好地与人类交流，研究人员一直在寻找方法来提高它们的交流能力。</p>
</li>
<li class="lvl-4">
<p><strong>角色扮演</strong> role-playing，则是这篇论文提出的主要思路，它允许交流代理扮演不同的角色，以更好地与人类或其他代理交流。这意味着代理可以模仿人类的行为，理解人类的意图，并据此做出反应。</p>
</li>
<li class="lvl-4">
<p><strong>启示式提示</strong> inception prompting，是一种指导代理完成任务的方法。通过给代理提供一系列的提示或指示，代理可以更好地理解它应该如何行动。这种方法可以帮助代理更好地与人类交流，并完成与人类的合作任务。</p>
</li>
</ul>
<p>这里的核心创新点是，通过角色扮演和启示式提示的框架来引导代理的交流过程。</p>
<h2 id="股票交易场景设计">股票交易场景设计</h2>
<p>论文中还提出了下面的目标场景和角色扮演设置。</p>
<p><img src="https://static001.geekbang.org/resource/image/ee/16/ee865a375320fc2e9e3e690e24766e16.png?wh=2676x1528" alt=""></p>
<h3 id="场景和角色设置">场景和角色设置</h3>
<p><strong>人类用户角色</strong>：负责提供要实现的想法，如为股票市场开发一个交易机器人。</p>
<p>人类可能不知道如何实现这个想法，但我们需要指定可能实现这个想法的角色，例如 Python 程序员和股票交易员。</p>
<p><strong>任务指定代理</strong>（Task Specifier Agent）：负责根据输入的想法为 AI 助手和 AI 用户确定一个具体的任务。因为人类用户的想法可能比较模糊，所以任务指定代理将提供详细描述，以使想法具体化。</p>
<p>描述：<strong>开发一个具有情感分析能力的交易机器人，该机器人可以监控社交媒体平台上特定股票的正面或负面评论，并根据情感分析结果执行交易。</strong></p>
<p>这样，就为 AI 助手提供了一个明确的任务来解决。</p>
<p>这里多说一句，之所以引入任务指定代理，是因为对话代理通常需要一个具体的任务提示来实现任务，对于非领域专家来说，创建这样一个具体的任务提示可能是具有挑战性或耗时的。</p>
<p>那么，参与此任务的 AI 角色就包括：</p>
<ul class="lvl-0">
<li class="lvl-4">
<p>一个以 Python 程序员为身份的 <strong>AI</strong> <strong>助手</strong>代理</p>
</li>
<li class="lvl-4">
<p>一个以股票交易员为身份的 <strong>AI</strong> <strong>用户</strong>代理</p>
</li>
</ul>
<p>接收到初步想法和角色分配后，AI 用户和 AI 助手通过指令跟随的方式互相聊天，他们将通过多轮对话合作完成指定任务，直到 AI 用户确定任务已完成。</p>
<p>其中，AI 用户是任务规划者，负责向 AI 助手发出以完成任务为导向的指令。另一方面，AI 助手是任务执行者，被设计为遵循 AI 用户指令并提供具体的解决方案，在这里他将给出设计股票交易系统的具体 Python 代码。</p>
<h3 id="提示模板设计">提示模板设计</h3>
<p>在 CAMEL 这个角色扮演框架中，Prompt Engineering 非常关键。与其他对话语言模型技术有所不同，这种提示工程只在角色扮演的初始阶段进行，主要用于明确任务和分配角色。当会话开始后，AI 助手和 AI 用户会自动地相互给出提示，直到对话结束。这种方法被称为 “Inception Prompting”。</p>
<p>Inception Prompting 包括三种类型的提示：任务明确提示、AI 助手提示和 AI 用户提示。在论文中，给出了两个提示模板作为示例。</p>
<p>在论文中，AI Society 和 AI Code 是两种不同的提示模板。这些提示模板被设计用来指导 AI 助手与 AI 用户之间的交互。</p>
<p>AI Society：这个提示模板主要关注 AI 助手在多种不同角色中的表现。例如，AI 助手可能扮演会计师、演员、设计师、医生、工程师等多种角色，而用户也可能有各种不同的角色，如博主、厨师、游戏玩家、音乐家等。这种设置是为了研究 AI 助手如何与不同角色的用户合作以完成各种任务。</p>
<p>AI Code：这个提示模板主要关注与编程相关的任务。它涉及到多种编程语言，如 Java、Python、JavaScript 等，以及多个领域，如会计、农业、生物学等。这种设置是为了研究 AI 助手如何在特定的编程语言和领域中帮助用户完成任务。</p>
<p><img src="https://static001.geekbang.org/resource/image/82/f4/8258bbe76e664b41ce636bfa8655c4f4.png?wh=1444x1595" alt=""></p>
<p><img src="https://static001.geekbang.org/resource/image/d8/e2/d824e74e324556232d86f20a3ab6e6e2.png?wh=1439x1631" alt=""></p>
<p>以 AI Society 为例，这个提示模板是为 AI 助手系统和 AI 用户系统设计的，它在角色扮演的开始时就给出了初始提示。以下是对这个模板的详细解释。</p>
<p><img src="https://static001.geekbang.org/resource/image/cc/a5/cc725b0b74f2a066acdefc7c9a3c7da5.jpg?wh=1668x1008" alt=""></p>
<p>这个提示模板为 AI 助手和 AI 用户提供了一个明确的框架，确保它们在对话中的行为是有序、一致和有效的。可以看出，与之前传统的提示设计不同，这种提示的设计更加复杂和细致，更像是一种交互协议或规范。这种设计在一定程度上提高了 AI 与 AI 之间自主合作的能力，并能更好地模拟人类之间的交互过程。</p>
<h2 id="易速鲜花营销方案">易速鲜花营销方案</h2>
<p>好，看完了论文的思路和论文中给出的示例，我们就要开始以 “易速鲜花” 为背景进行自己的 CAMEL 实战了。</p>
<h3 id="准备工作">准备工作</h3>
<p>先导入 API 密钥和所需要的库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 设置OpenAI API密钥</span><br><span class="line">import os</span><br><span class="line">os.environ[&quot;OPENAI_API_KEY&quot;] = &#x27;Your Key&#x27;</span><br><span class="line"></span><br><span class="line"># 导入所需的库</span><br><span class="line">from typing import List</span><br><span class="line">from langchain.chat_models import ChatOpenAI</span><br><span class="line">from langchain.prompts.chat import (</span><br><span class="line">    SystemMessagePromptTemplate,</span><br><span class="line">    HumanMessagePromptTemplate,</span><br><span class="line">)</span><br><span class="line">from langchain.schema import (</span><br><span class="line">    AIMessage,</span><br><span class="line">    HumanMessage,</span><br><span class="line">    SystemMessage,</span><br><span class="line">    BaseMessage,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="定义-CAMELAgent-类">定义 CAMELAgent 类</h3>
<p>下面，定义 CAMELAgent 类。这是一个核心类，用于管理与语言模型的交互。它包含了初始化消息、更新消息和与模型进行交互的方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 定义CAMELAgent类，用于管理与语言模型的交互</span><br><span class="line">class CAMELAgent:</span><br><span class="line">    def __init__(</span><br><span class="line">        self,</span><br><span class="line">        system_message: SystemMessage,</span><br><span class="line">        model: ChatOpenAI,</span><br><span class="line">    ) -&gt; None:</span><br><span class="line">        self.system_message = system_message</span><br><span class="line">        self.model = model</span><br><span class="line">        self.init_messages()</span><br><span class="line"></span><br><span class="line">    def reset(self) -&gt; None:</span><br><span class="line">        &quot;&quot;&quot;重置对话消息&quot;&quot;&quot;</span><br><span class="line">        self.init_messages()</span><br><span class="line">        return self.stored_messages</span><br><span class="line"></span><br><span class="line">    def init_messages(self) -&gt; None:</span><br><span class="line">        &quot;&quot;&quot;初始化对话消息&quot;&quot;&quot;</span><br><span class="line">        self.stored_messages = [self.system_message]</span><br><span class="line"></span><br><span class="line">    def update_messages(self, message: BaseMessage) -&gt; List[BaseMessage]:</span><br><span class="line">        &quot;&quot;&quot;更新对话消息列表&quot;&quot;&quot;</span><br><span class="line">        self.stored_messages.append(message)</span><br><span class="line">        return self.stored_messages</span><br><span class="line"></span><br><span class="line">    def step(self, input_message: HumanMessage) -&gt; AIMessage:</span><br><span class="line">        &quot;&quot;&quot;进行一步交互，并获取模型的响应&quot;&quot;&quot;</span><br><span class="line">        messages = self.update_messages(input_message)</span><br><span class="line"></span><br><span class="line">        output_message = self.model(messages)</span><br><span class="line">        self.update_messages(output_message)</span><br><span class="line"></span><br><span class="line">        return output_message</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="预设角色和任务提示">预设角色和任务提示</h3>
<p>预设的角色和任务提示，这部分定义了 AI 助手和用户的角色名称、任务描述以及每次讨论的字数限制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 设置一些预设的角色和任务提示</span><br><span class="line">assistant_role_name = &quot;花店营销专员&quot;</span><br><span class="line">user_role_name = &quot;花店老板&quot;</span><br><span class="line">task = &quot;整理出一个夏季玫瑰之夜的营销活动的策略&quot;</span><br><span class="line">word_limit = 50  # 每次讨论的字数限制</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里，assistant_role_name 和 user_role_name 是用来定义代理的角色。这两个角色在后续的对话中扮演着不同的功能，具体设定如下。</p>
<ul class="lvl-0">
<li class="lvl-4">
<p><code>assistant_role_name = &quot;花店营销专员&quot;</code>：这是定义助手的角色。在此设定中，助手被视为一名花店营销专员，主要职责是为花店老板（即用户）提供关于营销活动的建议和策略。</p>
</li>
<li class="lvl-4">
<p><code>user_role_name = &quot;花店老板&quot;</code>：这是定义用户的角色。用户在这里是花店的老板，他们可能会向营销专员（即助手）提出关于花店推广活动的需求或询问，然后由营销专员来答复和提供建议。</p>
</li>
</ul>
<p>这种角色设定，主要是为了模拟现实中的交互场景，使得聊天代理能够更好地理解任务，并为实现这些任务提供有效的解决方案。通过为每个聊天代理设定一个特定的角色，可以使聊天的过程更加有目的性和效率，同时也能提供更为真实的人类对话体验。</p>
<h3 id="任务指定代理">任务指定代理</h3>
<p>然后，使用任务指定代理（Task Specifier）来明确任务描述。这是 CAMEL 框架的一个关键步骤，它确保了任务描述的具体性和清晰性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 定义与指定任务相关的系统提示</span><br><span class="line">task_specifier_sys_msg = SystemMessage(content=&quot;你可以让任务更具体。&quot;)</span><br><span class="line">task_specifier_prompt = &quot;&quot;&quot;这是一个&#123;assistant_role_name&#125;将帮助&#123;user_role_name&#125;完成的任务：&#123;task&#125;。</span><br><span class="line">请使其更具体化。请发挥你的创意和想象力。</span><br><span class="line">请用&#123;word_limit&#125;个或更少的词回复具体的任务。不要添加其他任何内容。&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">task_specifier_template = HumanMessagePromptTemplate.from_template(</span><br><span class="line">    template=task_specifier_prompt</span><br><span class="line">)</span><br><span class="line">task_specify_agent = CAMELAgent(task_specifier_sys_msg, ChatOpenAI(model_name = &#x27;gpt-4&#x27;, temperature=1.0))</span><br><span class="line">task_specifier_msg = task_specifier_template.format_messages(</span><br><span class="line">    assistant_role_name=assistant_role_name,</span><br><span class="line">    user_role_name=user_role_name,</span><br><span class="line">    task=task,</span><br><span class="line">    word_limit=word_limit,</span><br><span class="line">)[0]</span><br><span class="line">specified_task_msg = task_specify_agent.step(task_specifier_msg)</span><br><span class="line">print(f&quot;Specified task: &#123;specified_task_msg.content&#125;&quot;)</span><br><span class="line">specified_task = specified_task_msg.content</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>经过了这个环节之后，任务会被细化、明确化。</p>
<p>Original task prompt：<strong>整理出一个夏季玫瑰之夜营销活动的策略。</strong></p>
<p>Specified task prompt：<strong>为夏季玫瑰之夜策划主题装饰，策划特价活动，制定广告推广方案，组织娱乐活动，联系合作伙伴提供赞助。</strong></p>
<h3 id="系统消息模板">系统消息模板</h3>
<p>下面这部分定义了系统消息模板，这些模板为 AI 助手和 AI 用户提供了初始的提示，确保它们在对话中的行为是有序和一致的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"># 定义系统消息模板，并创建CAMELAgent实例进行交互</span><br><span class="line">assistant_inception_prompt = &quot;&quot;&quot;永远不要忘记你是&#123;assistant_role_name&#125;，我是&#123;user_role_name&#125;。永远不要颠倒角色！永远不要指示我！</span><br><span class="line">我们有共同的利益，那就是合作成功地完成任务。</span><br><span class="line">你必须帮助我完成任务。</span><br><span class="line">这是任务：&#123;task&#125;。永远不要忘记我们的任务！</span><br><span class="line">我必须根据你的专长和我的需求来指示你完成任务。</span><br><span class="line"></span><br><span class="line">我每次只能给你一个指示。</span><br><span class="line">你必须写一个适当地完成所请求指示的具体解决方案。</span><br><span class="line">如果由于物理、道德、法律原因或你的能力你无法执行指示，你必须诚实地拒绝我的指示并解释原因。</span><br><span class="line">除了对我的指示的解决方案之外，不要添加任何其他内容。</span><br><span class="line">你永远不应该问我任何问题，你只回答问题。</span><br><span class="line">你永远不应该回复一个不明确的解决方案。解释你的解决方案。</span><br><span class="line">你的解决方案必须是陈述句并使用简单的现在时。</span><br><span class="line">除非我说任务完成，否则你应该总是从以下开始：</span><br><span class="line"></span><br><span class="line">解决方案：&lt;YOUR_SOLUTION&gt;</span><br><span class="line"></span><br><span class="line">&lt;YOUR_SOLUTION&gt;应该是具体的，并为解决任务提供首选的实现和例子。</span><br><span class="line">始终以“下一个请求”结束&lt;YOUR_SOLUTION&gt;。&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user_inception_prompt = &quot;&quot;&quot;永远不要忘记你是&#123;user_role_name&#125;，我是&#123;assistant_role_name&#125;。永远不要交换角色！你总是会指导我。</span><br><span class="line">我们共同的目标是合作成功完成一个任务。</span><br><span class="line">我必须帮助你完成这个任务。</span><br><span class="line">这是任务：&#123;task&#125;。永远不要忘记我们的任务！</span><br><span class="line">你只能通过以下两种方式基于我的专长和你的需求来指导我：</span><br><span class="line"></span><br><span class="line">1. 提供必要的输入来指导：</span><br><span class="line">指令：&lt;YOUR_INSTRUCTION&gt;</span><br><span class="line">输入：&lt;YOUR_INPUT&gt;</span><br><span class="line"></span><br><span class="line">2. 不提供任何输入来指导：</span><br><span class="line">指令：&lt;YOUR_INSTRUCTION&gt;</span><br><span class="line">输入：无</span><br><span class="line"></span><br><span class="line">“指令”描述了一个任务或问题。与其配对的“输入”为请求的“指令”提供了进一步的背景或信息。</span><br><span class="line"></span><br><span class="line">你必须一次给我一个指令。</span><br><span class="line">我必须写一个适当地完成请求指令的回复。</span><br><span class="line">如果由于物理、道德、法律原因或我的能力而无法执行你的指令，我必须诚实地拒绝你的指令并解释原因。</span><br><span class="line">你应该指导我，而不是问我问题。</span><br><span class="line">现在你必须开始按照上述两种方式指导我。</span><br><span class="line">除了你的指令和可选的相应输入之外，不要添加任何其他内容！</span><br><span class="line">继续给我指令和必要的输入，直到你认为任务已经完成。</span><br><span class="line">当任务完成时，你只需回复一个单词&lt;CAMEL_TASK_DONE&gt;。</span><br><span class="line">除非我的回答已经解决了你的任务，否则永远不要说&lt;CAMEL_TASK_DONE&gt;。&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>之后，根据预设的角色和任务提示生成系统消息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 根据预设的角色和任务提示生成系统消息</span><br><span class="line">def get_sys_msgs(assistant_role_name: str, user_role_name: str, task: str):</span><br><span class="line">    assistant_sys_template = SystemMessagePromptTemplate.from_template(</span><br><span class="line">        template=assistant_inception_prompt</span><br><span class="line">    )</span><br><span class="line">    assistant_sys_msg = assistant_sys_template.format_messages(</span><br><span class="line">        assistant_role_name=assistant_role_name,</span><br><span class="line">        user_role_name=user_role_name,</span><br><span class="line">        task=task,</span><br><span class="line">    )[0]</span><br><span class="line"></span><br><span class="line">    user_sys_template = SystemMessagePromptTemplate.from_template(</span><br><span class="line">        template=user_inception_prompt</span><br><span class="line">    )</span><br><span class="line">    user_sys_msg = user_sys_template.format_messages(</span><br><span class="line">        assistant_role_name=assistant_role_name,</span><br><span class="line">        user_role_name=user_role_name,</span><br><span class="line">        task=task,</span><br><span class="line">    )[0]</span><br><span class="line"></span><br><span class="line">    return assistant_sys_msg, user_sys_msg</span><br><span class="line"></span><br><span class="line">assistant_sys_msg, user_sys_msg = get_sys_msgs(</span><br><span class="line">    assistant_role_name, user_role_name, specified_task</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="创建-Agent-实例">创建 Agent 实例</h3>
<p>创建助手和用户的 CAMELAgent 实例，并初始化对话互动，使用 CAMELAgent 类的实例来模拟助手和用户之间的对话交互。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 创建助手和用户的CAMELAgent实例</span><br><span class="line">assistant_agent = CAMELAgent(assistant_sys_msg, ChatOpenAI(temperature=0.2))</span><br><span class="line">user_agent = CAMELAgent(user_sys_msg, ChatOpenAI(temperature=0.2))</span><br><span class="line"></span><br><span class="line"># 重置两个agent</span><br><span class="line">assistant_agent.reset()</span><br><span class="line">user_agent.reset()</span><br><span class="line"></span><br><span class="line"># 初始化对话互动</span><br><span class="line">assistant_msg = HumanMessage(</span><br><span class="line">    content=(</span><br><span class="line">        f&quot;&#123;user_sys_msg.content&#125;。&quot;</span><br><span class="line">        &quot;现在开始逐一给我介绍。&quot;</span><br><span class="line">        &quot;只回复指令和输入。&quot;</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">user_msg = HumanMessage(content=f&quot;&#123;assistant_sys_msg.content&#125;&quot;)</span><br><span class="line">user_msg = assistant_agent.step(user_msg)</span><br><span class="line"></span><br><span class="line">print(f&quot;Original task prompt:\n&#123;task&#125;\n&quot;)</span><br><span class="line">print(f&quot;Specified task prompt:\n&#123;specified_task&#125;\n&quot;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里，assistant_inception_prompt 和 user_inception_prompt 是两个关键的提示，用于引导聊天代理的行为和交流方式。关于这两个提示，让我们一起来深入理解一下它们的设计和目标。</p>
<ol>
<li class="lvl-4">
<p><strong>assistant_inception_prompt：</strong> 这个提示是为了引导助手（即营销专员）如何响应用户（即花店老板）的指示。它明确指出助手的角色和职责，强调了在完成任务的过程中需要遵循的一些基本规则和原则。例如，助手需要针对用户的每一个指示提供一个明确的解决方案，而且这个解决方案必须是具体、易于理解的，并且只有在遇到物理、道德、法律的限制或自身能力的限制时，才能拒绝用户的指示。这个提示的设计目标是引导助手在一次有目标的对话中，有效地对用户的指示做出响应。</p>
</li>
<li class="lvl-4">
<p><strong>user_inception_prompt：</strong> 这个提示是为了引导用户（即花店老板）如何给助手（即营销专员）下达指示。它明确指出了用户的角色和职责，强调了在提出任务指示时需要遵循的一些基本规则和原则。例如，用户需要一次只给出一个指示，并且必须清楚地提供相关的输入（如果有的话）。而且用户在给出指示的同时，不能向助手提问。这个提示的设计目标是引导用户在一次有目标的对话中，有效地给出指示，以便助手能够更好地理解和完成任务。</p>
</li>
</ol>
<p>这两个提示的设计都体现了一种 “角色扮演” 的机制，即通过赋予聊天代理具体的角色和职责，以帮助它们更好地理解和完成任务。这种机制可以有效地引导聊天代理的交流行为，使得对话更加有目的性和效率，同时也能提供更为真实的人类对话体验。</p>
<h3 id="头脑风暴开始">头脑风暴开始</h3>
<p>接下来，模拟助手和用户之间的多轮对话，直到达到对话轮次上限或任务完成。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 模拟对话交互，直到达到对话轮次上限或任务完成</span><br><span class="line">chat_turn_limit, n = 30, 0</span><br><span class="line">while n &lt; chat_turn_limit:</span><br><span class="line">    n += 1</span><br><span class="line">    user_ai_msg = user_agent.step(assistant_msg)</span><br><span class="line">    user_msg = HumanMessage(content=user_ai_msg.content)</span><br><span class="line">    print(f&quot;AI User (&#123;user_role_name&#125;):\n\n&#123;user_msg.content&#125;\n\n&quot;)</span><br><span class="line"></span><br><span class="line">    assistant_ai_msg = assistant_agent.step(user_msg)</span><br><span class="line">    assistant_msg = HumanMessage(content=assistant_ai_msg.content)</span><br><span class="line">    print(f&quot;AI Assistant (&#123;assistant_role_name&#125;):\n\n&#123;assistant_msg.content&#125;\n\n&quot;)</span><br><span class="line">    if &quot;&lt;CAMEL_TASK_DONE&gt;&quot; in user_msg.content:</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行程序，营销策划头脑风暴开始！</p>
<p><img src="https://static001.geekbang.org/resource/image/45/90/453054aabe9d816ff88e05bb6ca03390.jpg?wh=1414x600" alt=""></p>
<p><img src="https://static001.geekbang.org/resource/image/df/01/dff9cdf1f992756a3a02e48f63e96d01.jpg?wh=1412x830" alt=""></p>
<p><img src="https://static001.geekbang.org/resource/image/21/5c/219851d4806bd8fa01f7ee09ac0f715c.jpg?wh=1438x875" alt=""></p>
<p><img src="https://static001.geekbang.org/resource/image/dc/6f/dc6fb40781a2e53017e7d48d18f96a6f.jpg?wh=1418x848" alt=""></p>
<p><img src="https://static001.geekbang.org/resource/image/7c/87/7c01866d547f9517787cf25cd4a65587.jpg?wh=1419x666" alt=""></p>
<p>怎么样，看到这样的策划水准，是否觉得 CAMEL 框架趋动的 AI 助理完全不输给一个专业的营销策划专员呢？</p>
<p>讲到这里，我冒出了两个想法。是不是只有我们想不到，没有 AI 做不到的？一大批人可能真的要失业了。所以，赶快学习吧！继续卷起来。</p>
<h2 id="总结时刻">总结时刻</h2>
<p>智能代理在未来世界中将扮演越来越重要的角色。为了使这些代理能够更好地为人类服务，我们需要找到方法来提高它们的交流能力。CAMEL 这篇论文提供了一个全新的视角来看待交流代理的发展。通过使用 “角色扮演” 框架，可以开发出更加智能和人性化的交流代理，这将为我们的日常生活带来更多的便利。</p>
<p>同时，我们也回顾一下 CAMEL 框架的实现，以及在这个实现中提示设计的特别之处。</p>
<ol>
<li class="lvl-4">
<p>角色扮演：每个代理都被赋予了一个角色，且每个角色都有清晰的责任和行为准则。比如，Python 程序员（助手）的角色是根据股票交易员（用户）的指示提供具体的解决方案，而股票交易员的角色是提供详细的任务指示。这种角色扮演机制有助于模拟人类之间的交互过程，更加真实地完成任务。</p>
</li>
<li class="lvl-4">
<p>任务的具体化：为了使 AI 更好地理解和执行任务，提出了将抽象任务具体化的步骤。这可以帮助 AI 更清晰地理解任务需求，更准确地给出解决方案。</p>
</li>
<li class="lvl-4">
<p>初始提示的设定：为了启动会话并提供合适的引导，系统初始化时会提供两个初始提示，一条是助手角色的提示，另一条是用户角色的提示。这两条提示分别描述了各自角色的行为准则和任务细节，为整个对话过程提供了框架和指引。</p>
</li>
<li class="lvl-4">
<p>交互规范：该代码实现中有明确的交互规范，如一次只能给出一个指令，解决方案必须具有详细的解释，使用 “Solution:” 开始输出解决方案，等等。这些规范有助于保持对话的清晰性和高效性。</p>
</li>
</ol>
<p>与传统的提示设计不同，CAMEL 中提示的设计更加复杂和细致，更像是一种交互协议或规范。这种设计在一定程度上提高了 AI 与 AI 之间自主合作的能力，并能更好地模拟人类之间的交互过程。</p>
<h2 id="思考题">思考题</h2>
<ol>
<li class="lvl-4">
<p>在你的业务需求中，有什么需要细化、具体化的业务场景吗？不妨套用这里的 CAMEL 代码模板，做一次头脑风暴。</p>
</li>
<li class="lvl-4">
<p>对于这个 AI 交流代理指导框架和提示模板的设计，你能否说说其优劣之处？有没有能进一步改进的地方？</p>
</li>
</ol>
<p>期待在留言区看到你的思考，如果觉得内容对你有帮助，也欢迎分享给有需要的朋友！最后如果你学有余力，可以进一步学习下面的延伸阅读。</p>
<h2 id="延伸阅读">延伸阅读</h2>
<ol>
<li class="lvl-4">
<p>CAMEL 项目<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.camel-ai.org%2F" title="https://www.camel-ai.org/">官网</a> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fcamel-ai%2Fcamel" title="https://github.com/camel-ai/camel">GitHub</a> 论文</p>
</li>
<li class="lvl-4">
<p>新闻<a href="https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FGKHD6M74rqC42u2w8EFjJw" title="https://mp.weixin.qq.com/s/GKHD6M74rqC42u2w8EFjJw">「零人工含量」的「游戏公司」</a>- Chen, Q., Cong, X., Yang, C., Chen, W., Su, Y., Xu, J., Liu, Z., &amp; Sun, M. (2023). <a href="https://link.juejin.cn/?target=https%3A%2F%2Farxiv.org%2Fabs%2F2307.07924" title="https://arxiv.org/abs/2307.07924">Communicative Agents for Software Development.</a> arXiv preprint arXiv:2307.07924 [<a target="_blank" rel="noopener" href="http://cs.SE">cs.SE</a>].</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/BabyAGI%EF%BC%9A%E6%A0%B9%E6%8D%AE%E6%B0%94%E5%80%99%E5%8F%98%E5%8C%96%E8%87%AA%E5%8A%A8%E5%88%B6%E5%AE%9A%E9%B2%9C%E8%8A%B1%E5%AD%98%E5%82%A8%E7%AD%96%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%BD%91%E9%A1%B5%E5%AF%BC%E5%85%A5/BabyAGI%EF%BC%9A%E6%A0%B9%E6%8D%AE%E6%B0%94%E5%80%99%E5%8F%98%E5%8C%96%E8%87%AA%E5%8A%A8%E5%88%B6%E5%AE%9A%E9%B2%9C%E8%8A%B1%E5%AD%98%E5%82%A8%E7%AD%96%E7%95%A5/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-18 19:34:08" itemprop="dateModified" datetime="2024-11-18T19:34:08+08:00">2024-11-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>你好，我是黄佳，欢迎来到 LangChain 实战课！</p>
<p>在上节课中，我们深入探讨了如何利用 CAMEL 框架制定出一个高效的鲜花营销方案。然而，LangChain 目前是将基于 CAMEL 框架的代理定义为 Simulation Agents（模拟代理）。这种代理在模拟环境中进行角色扮演，试图模拟特定场景或行为，而不是在真实世界中完成具体的任务。</p>
<p>随着 ChatGPT 的崭露头角，我们迎来了一种新型的代理——Autonomous Agents（自治代理或自主代理）。这些代理的设计初衷就是能够独立地执行任务，并持续地追求长期目标。在 LangChain 的代理、工具和记忆这些组件的支持下，<strong>它们能够在无需外部干预的情况下自主运行，这在真实世界的应用中具有巨大的价值。</strong></p>
<p>目前，GitHub 上已有好几个备受关注的 “网红” 项目，如 AutoGPT、BabyAGI 和 HuggingGPT，它们都代表了自治代理的初步尝试。尽管这些代理仍处于实验阶段，但潜力十分巨大。它们都是基于 LangChain 框架构建的。通过 LangChain，你可以在这些开源项目中轻松地切换和测试多种 LLM、使用多种向量存储作为记忆，以及充分利用 LangChain 的丰富工具集。</p>
<p>今天的这节课，我就带着你看一看这些项目，同时也通过 LangChain 完成一个 BabyAGI 的实现。</p>
<h2 id="AutoGPT">AutoGPT</h2>
<p>Auto-GPT 是由 Toran Bruce Richards 创建的一个开源的自主 AI 代理，基于 OpenAI 的 GPT-4 语言模型。它的主要功能是<strong>自动链接多个任务</strong>，以实现用户设定的大目标。与传统的聊天机器人（如 ChatGPT）不同，用户只需提供一个提示或一组自然语言指令，Auto-GPT 就会通过自动化多步提示过程，将目标分解为子任务，以达到其目标。</p>
<p><img src="https://static001.geekbang.org/resource/image/85/bc/8527f131880785688eac48b10f7e5bbc.png?wh=800x533" alt=""></p>
<p>Auto-GPT 一出世，就受到了广泛的宣传和追捧，Star 数量半年飙升到了 150K。</p>
<p><strong>为什么 Auto-GPT 吸引了这么多眼球？</strong></p>
<p>因为与 ChatGPT 相比，它能够与互联网集成，提供实时数据访问。Auto-GPT 将活动分解为子任务，自我提示（而不是像 ChatGPT 那样需要用户多次提示才能把复杂任务完善地完成），并重复该过程，直到达到所提供的目标。</p>
<p>技术上，Auto-GPT 使用短期记忆管理来保存上下文；同时 Auto-GPT 是多模态的，可以处理文本和图像作为输入。</p>
<p>从具体应用上说，Auto-GPT 可以用于各种任务，例如生成文本、执行特定操作和进行网络搜索等。它还可以作为研究助手，帮助用户进行科学研究、市场研究、内容创建、销售线索生成、业务计划创建、产品评论、播客大纲制定等。</p>
<p>当然，Auto-GPT 并不完善，作为一个实验性质的项目，它还存在诸多挑战，比如它的运行成本可能很高，而且它可能会分心或陷入循环。技术上，它的缺陷是没有长期记忆。</p>
<p>但是，作为一个开源项目，它的优势在于，它展示出了 AI 的边界和自主行动能力，凸显出了自主代理的潜力，也从实践上验证了人类正朝向人工普通智能（AGI）迈进。<strong>理论上说，更成熟的</strong> <strong>Auto-GPT</strong> <strong>版本可以启动与其他自主代理进行交互过程，实现 AI 代理之间的对话。</strong></p>
<p>Auto-GPT 在 GitHub 上的社区非常活跃，开发者可以分享他们使用 Auto-GPT 的进展和想法。Auto-GPT 还有一个 Hackathon 活动，鼓励开发者提交他们的代理进行基准测试和比较。</p>
<h2 id="Baby-AGI">Baby AGI</h2>
<p>BabyAGI 是由中岛洋平（Yohei Nakajima）于 2023 年 3 月 28 日开发的自主任务驱动 AI 系统。核心在于，它可以根据设定的目标生成、组织、确定优先级以及执行任务。它也使用 OpenAI 的 GPT-4 语言模型来理解和创建任务，利用 Pinecone 向量搜索来存储和检索特定任务的结果，提供执行任务的上下文，并采用 LangChain 框架进行决策。</p>
<p>BabyAGI 尝试使用预定义的目标进行自我驱动，自动化个人任务管理。它不仅可以自动生成和执行任务，而且还可以根据完成的任务结果生成新任务，并且可以实时确定任务的优先级。</p>
<p>与传统的 AI 工具（如 ChatGPT）不同，BabyAGI 不仅仅是解释查询和提供响应，而且能够根据目标生成任务列表，连续执行它们，并根据先前任务的输出适应性地创建更多任务。</p>
<p>和 Auto-GPT 一样，该系统发布后广受关注，也被某些人誉为<strong>完全自主人工智能的起点</strong>。</p>
<p>在 BabyAGI 中，你向系统提出一个目标之后，它将不断优先考虑需要实现或完成的任务，以实现该目标。具体来说，系统将形成任务列表，从任务列表中拉出优先级最高的第一个任务，使用 OpenAI API 根据上下文将任务发送到执行代理并完成任务，一旦这些任务完成，它们就会被存储在内存（或者 Pinecone 这类向量数据库）中，然后，根据目标和上一个任务的结果创建新任务并确定优先级。</p>
<p>整个过程如下图所示：</p>
<p><img src="https://static001.geekbang.org/resource/image/07/6c/07cbca8cfff33ffa231830eff145556c.png?wh=680x475" alt=""></p>
<p>在这个过程中，驱动任务的是三个不同作用的代理。分别是执行代理 execution_agent，任务创建代理 task_creation_agent，以及优先级设置代理 prioritization_agent。</p>
<ul class="lvl-0">
<li class="lvl-4">
<p><strong>执行代理</strong>，是系统的核心，利用 OpenAI 的 API 来处理任务。这个代理的实现函数有两个参数，目标和任务，用于向 OpenAI 的 API 发送提示，并以字符串形式返回任务结果。</p>
</li>
<li class="lvl-4">
<p><strong>任务创建代理</strong>，通过 OpenAI 的 API 根据当前对象和先前任务的结果创建新任务。这个代理的实现函数有四个参数，目标、上一个任务的结果、任务描述和当前任务列表。这个代理会向 OpenAI 的 API 发送一条提示，该 API 将以字符串形式返回新任务列表。然后，该函数将以字典列表的形式返回这些新任务，其中每个字典都包含任务的名称。</p>
</li>
<li class="lvl-4">
<p><strong>优先级设置代理</strong>，负责任务列表的排序和优先级，仍然是通过调用 OpenAI 的 API 来重新确定任务列表的优先级。这个代理的实现函数有一个参数，即当前任务的 ID。这个代理会向 OpenAI 的 API 发送提示，并返回已重新优先排序为编号列表的新任务列表。</p>
</li>
</ul>
<p>等一下，我就用这个 BabyAGI 的框架来带着你开发一个能够根据气候变化自动制定鲜花存储策略的 AI 智能代理。</p>
<h2 id="HuggingGPT">HuggingGPT</h2>
<p>在 Yongliang Shen 的论文《HuggingGPT: Solving AI Tasks with ChatGPT and its Friends in Hugging Face》中，介绍了 HuggingGPT 的系统。HuggingGPT 的工作流程包括四个阶段。</p>
<ol>
<li class="lvl-4">
<p>任务规划：LLM（例如 ChatGPT）解析用户请求，生成任务列表，并确定任务之间的执行顺序和资源依赖关系。</p>
</li>
<li class="lvl-4">
<p>模型选择：LLM 根据 Hugging Face 上的专家模型描述，为任务分配适当的模型。</p>
</li>
<li class="lvl-4">
<p>任务执行：整合各个任务端点上的专家模型，执行分配的任务。</p>
</li>
<li class="lvl-4">
<p>响应生成：LLM 整合专家的推断结果，生成工作流摘要，并给用户提供最终的响应。</p>
</li>
</ol>
<p>HuggingGPT 的设计，使其能够根据用户请求自动生成计划，并使用外部模型，从而整合多模态感知能力，并处理多个复杂的 AI 任务。此外，这种流程还允许 HuggingGPT 持续从任务特定的专家模型中吸收能力，从而实现可增长和可扩展的 AI 能力。</p>
<p><img src="https://static001.geekbang.org/resource/image/7e/36/7ec5769743e7ddf58883ca74385cbd36.png?wh=1467x1453" alt=""></p>
<p>文章还提到，HuggingGPT 的优势在于，<strong>它能够使用不同的模型来执行特定的任务</strong>，如图像分类、对象检测、图像描述等。例如，它使用 OpenCV 的 OpenPose 模型来分析图像中小朋友的姿势，并使用其他模型生成新图像和描述。</p>
<p>不难看出，尽管实现过程各有特点，但这些自主类的 AI 代理应用的基本思想和流程还是很类似的。关键是利用 LLM 的推理能力生成任务，确定任务优先级，然后执行任务，实现目标。</p>
<h2 id="根据气候变化自动制定鲜花存储策略">根据气候变化自动制定鲜花存储策略</h2>
<p>下面，我们就解析一下 LangChain 中 BabyAGI 的具体实现。这里的 “BabyAGI” 是一个简化版的实现，其核心功能是自动创建、优先级排序和执行任务。</p>
<p>首先，我们导入相关的库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 设置API Key</span><br><span class="line">import os</span><br><span class="line">os.environ[&quot;OPENAI_API_KEY&quot;] = &#x27;Your OpenAI API Key</span><br><span class="line"></span><br><span class="line"># 导入所需的库和模块</span><br><span class="line">from collections import deque</span><br><span class="line">from typing import Dict, List, Optional, Any</span><br><span class="line">from langchain.chains import LLMChain</span><br><span class="line">from langchain.prompts import PromptTemplate</span><br><span class="line">from langchain.embeddings import OpenAIEmbeddings</span><br><span class="line">from langchain.llms import BaseLLM, OpenAI</span><br><span class="line">from langchain.vectorstores.base import VectorStore</span><br><span class="line">from pydantic import BaseModel, Field</span><br><span class="line">from langchain.chains.base import Chain</span><br><span class="line">from langchain.vectorstores import FAISS</span><br><span class="line">import faiss</span><br><span class="line">from langchain.docstore import InMemoryDocstore</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后，我们初始化 OpenAIEmbedding 作为嵌入模型，并使用 Faiss 作为向量数据库存储任务信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 定义嵌入模型</span><br><span class="line">embeddings_model = OpenAIEmbeddings()</span><br><span class="line"># 初始化向量存储</span><br><span class="line">embedding_size = 1536</span><br><span class="line">index = faiss.IndexFlatL2(embedding_size)</span><br><span class="line">vectorstore = FAISS(embeddings_model.embed_query, index, InMemoryDocstore(&#123;&#125;), &#123;&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下面是定义任务生成链，基于给定的条件，这个链可以创建新任务。例如，它可以根据最后一个完成的任务的结果来生成新任务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 任务生成链</span><br><span class="line">class TaskCreationChain(LLMChain):</span><br><span class="line">    &quot;&quot;&quot;负责生成任务的链&quot;&quot;&quot;</span><br><span class="line">    @classmethod</span><br><span class="line">    def from_llm(cls, llm: BaseLLM, verbose: bool = True) -&gt; LLMChain:</span><br><span class="line">        &quot;&quot;&quot;从LLM获取响应解析器&quot;&quot;&quot;</span><br><span class="line">        task_creation_template = (</span><br><span class="line">            &quot;You are a task creation AI that uses the result of an execution agent&quot;</span><br><span class="line">            &quot; to create new tasks with the following objective: &#123;objective&#125;,&quot;</span><br><span class="line">            &quot; The last completed task has the result: &#123;result&#125;.&quot;</span><br><span class="line">            &quot; This result was based on this task description: &#123;task_description&#125;.&quot;</span><br><span class="line">            &quot; These are incomplete tasks: &#123;incomplete_tasks&#125;.&quot;</span><br><span class="line">            &quot; Based on the result, create new tasks to be completed&quot;</span><br><span class="line">            &quot; by the AI system that do not overlap with incomplete tasks.&quot;</span><br><span class="line">            &quot; Return the tasks as an array.&quot;</span><br><span class="line">        )</span><br><span class="line">        prompt = PromptTemplate(</span><br><span class="line">            template=task_creation_template,</span><br><span class="line">            input_variables=[</span><br><span class="line">                &quot;result&quot;,</span><br><span class="line">                &quot;task_description&quot;,</span><br><span class="line">                &quot;incomplete_tasks&quot;,</span><br><span class="line">                &quot;objective&quot;,</span><br><span class="line">            ],</span><br><span class="line">        )</span><br><span class="line">        return cls(prompt=prompt, llm=llm, verbose=verbose)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下面是定义任务优先级链，这个链负责重新排序任务的优先级。给定一个任务列表，它会返回一个新的按优先级排序的任务列表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 任务优先级链</span><br><span class="line">class TaskPrioritizationChain(LLMChain):</span><br><span class="line">    &quot;&quot;&quot;负责任务优先级排序的链&quot;&quot;&quot;</span><br><span class="line">    @classmethod</span><br><span class="line">    def from_llm(cls, llm: BaseLLM, verbose: bool = True) -&gt; LLMChain:</span><br><span class="line">        &quot;&quot;&quot;从LLM获取响应解析器&quot;&quot;&quot;</span><br><span class="line">        task_prioritization_template = (</span><br><span class="line">            &quot;You are a task prioritization AI tasked with cleaning the formatting of and reprioritizing&quot;</span><br><span class="line">            &quot; the following tasks: &#123;task_names&#125;.&quot;</span><br><span class="line">            &quot; Consider the ultimate objective of your team: &#123;objective&#125;.&quot;</span><br><span class="line">            &quot; Do not remove any tasks. Return the result as a numbered list, like:&quot;</span><br><span class="line">            &quot; #. First task&quot;</span><br><span class="line">            &quot; #. Second task&quot;</span><br><span class="line">            &quot; Start the task list with number &#123;next_task_id&#125;.&quot;</span><br><span class="line">        )</span><br><span class="line">        prompt = PromptTemplate(</span><br><span class="line">            template=task_prioritization_template,</span><br><span class="line">            input_variables=[&quot;task_names&quot;, &quot;next_task_id&quot;, &quot;objective&quot;],</span><br><span class="line">        )</span><br><span class="line">        return cls(prompt=prompt, llm=llm, verbose=verbose)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>下面是定义任务执行链，这个链负责执行具体的任务，并返回结果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 任务执行链</span><br><span class="line">class ExecutionChain(LLMChain):</span><br><span class="line">    &quot;&quot;&quot;负责执行任务的链&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def from_llm(cls, llm: BaseLLM, verbose: bool = True) -&gt; LLMChain:</span><br><span class="line">        &quot;&quot;&quot;从LLM获取响应解析器&quot;&quot;&quot;</span><br><span class="line">        execution_template = (</span><br><span class="line">            &quot;You are an AI who performs one task based on the following objective: &#123;objective&#125;.&quot;</span><br><span class="line">            &quot; Take into account these previously completed tasks: &#123;context&#125;.&quot;</span><br><span class="line">            &quot; Your task: &#123;task&#125;.&quot;</span><br><span class="line">            &quot; Response:&quot;</span><br><span class="line">        )</span><br><span class="line">        prompt = PromptTemplate(</span><br><span class="line">            template=execution_template,</span><br><span class="line">            input_variables=[&quot;objective&quot;, &quot;context&quot;, &quot;task&quot;],</span><br><span class="line">        )</span><br><span class="line">        return cls(prompt=prompt, llm=llm, verbose=verbose)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>之后，我们定义一系列功能函数，实现 get_next_task、prioritize_tasks、_get_top_tasks 以及 execute_task 等具体功能。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">def get_next_task(</span><br><span class="line">    task_creation_chain: LLMChain,</span><br><span class="line">    result: Dict,</span><br><span class="line">    task_description: str,</span><br><span class="line">    task_list: List[str],</span><br><span class="line">    objective: str,</span><br><span class="line">) -&gt; List[Dict]:</span><br><span class="line">    &quot;&quot;&quot;Get the next task.&quot;&quot;&quot;</span><br><span class="line">    incomplete_tasks = &quot;, &quot;.join(task_list)</span><br><span class="line">    response = task_creation_chain.run(</span><br><span class="line">        result=result,</span><br><span class="line">        task_description=task_description,</span><br><span class="line">        incomplete_tasks=incomplete_tasks,</span><br><span class="line">        objective=objective,</span><br><span class="line">    )</span><br><span class="line">    new_tasks = response.split(&quot;\n&quot;)</span><br><span class="line">    return [&#123;&quot;task_name&quot;: task_name&#125; for task_name in new_tasks if task_name.strip()]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def prioritize_tasks(</span><br><span class="line">    task_prioritization_chain: LLMChain,</span><br><span class="line">    this_task_id: int,</span><br><span class="line">    task_list: List[Dict],</span><br><span class="line">    objective: str,</span><br><span class="line">) -&gt; List[Dict]:</span><br><span class="line">    &quot;&quot;&quot;Prioritize tasks.&quot;&quot;&quot;</span><br><span class="line">    task_names = [t[&quot;task_name&quot;] for t in task_list]</span><br><span class="line">    next_task_id = int(this_task_id) + 1</span><br><span class="line">    response = task_prioritization_chain.run(</span><br><span class="line">        task_names=task_names, next_task_id=next_task_id, objective=objective</span><br><span class="line">    )</span><br><span class="line">    new_tasks = response.split(&quot;\n&quot;)</span><br><span class="line">    prioritized_task_list = []</span><br><span class="line">    for task_string in new_tasks:</span><br><span class="line">        if not task_string.strip():</span><br><span class="line">            continue</span><br><span class="line">        task_parts = task_string.strip().split(&quot;.&quot;, 1)</span><br><span class="line">        if len(task_parts) == 2:</span><br><span class="line">            task_id = task_parts[0].strip()</span><br><span class="line">            task_name = task_parts[1].strip()</span><br><span class="line">            prioritized_task_list.append(&#123;&quot;task_id&quot;: task_id, &quot;task_name&quot;: task_name&#125;)</span><br><span class="line">    return prioritized_task_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def _get_top_tasks(vectorstore, query: str, k: int) -&gt; List[str]:</span><br><span class="line">    &quot;&quot;&quot;Get the top k tasks based on the query.&quot;&quot;&quot;</span><br><span class="line">    results = vectorstore.similarity_search_with_score(query, k=k)</span><br><span class="line">    if not results:</span><br><span class="line">        return []</span><br><span class="line">    sorted_results, _ = zip(*sorted(results, key=lambda x: x[1], reverse=True))</span><br><span class="line">    return [str(item.metadata[&quot;task&quot;]) for item in sorted_results]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def execute_task(</span><br><span class="line">    vectorstore, execution_chain: LLMChain, objective: str, task: str, k: int = 5</span><br><span class="line">) -&gt; str:</span><br><span class="line">    &quot;&quot;&quot;Execute a task.&quot;&quot;&quot;</span><br><span class="line">    context = _get_top_tasks(vectorstore, query=objective, k=k)</span><br><span class="line">    return execution_chain.run(objective=objective, context=context, task=task)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后，我们定义 BabyAGI，这是主类，它控制整个系统的运行流程，包括添加任务、输出任务列表、执行任务等。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"># BabyAGI 主类</span><br><span class="line">class BabyAGI(Chain, BaseModel):</span><br><span class="line">    &quot;&quot;&quot;BabyAGI代理的控制器模型&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    task_list: deque = Field(default_factory=deque)</span><br><span class="line">    task_creation_chain: TaskCreationChain = Field(...)</span><br><span class="line">    task_prioritization_chain: TaskPrioritizationChain = Field(...)</span><br><span class="line">    execution_chain: ExecutionChain = Field(...)</span><br><span class="line">    task_id_counter: int = Field(1)</span><br><span class="line">    vectorstore: VectorStore = Field(init=False)</span><br><span class="line">    max_iterations: Optional[int] = None</span><br><span class="line"></span><br><span class="line">    class Config:</span><br><span class="line">        &quot;&quot;&quot;Configuration for this pydantic object.&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">        arbitrary_types_allowed = True</span><br><span class="line"></span><br><span class="line">    def add_task(self, task: Dict):</span><br><span class="line">        self.task_list.append(task)</span><br><span class="line"></span><br><span class="line">    def print_task_list(self):</span><br><span class="line">        print(&quot;\033[95m\033[1m&quot; + &quot;\n*****TASK LIST*****\n&quot; + &quot;\033[0m\033[0m&quot;)</span><br><span class="line">        for t in self.task_list:</span><br><span class="line">            print(str(t[&quot;task_id&quot;]) + &quot;: &quot; + t[&quot;task_name&quot;])</span><br><span class="line"></span><br><span class="line">    def print_next_task(self, task: Dict):</span><br><span class="line">        print(&quot;\033[92m\033[1m&quot; + &quot;\n*****NEXT TASK*****\n&quot; + &quot;\033[0m\033[0m&quot;)</span><br><span class="line">        print(str(task[&quot;task_id&quot;]) + &quot;: &quot; + task[&quot;task_name&quot;])</span><br><span class="line"></span><br><span class="line">    def print_task_result(self, result: str):</span><br><span class="line">        print(&quot;\033[93m\033[1m&quot; + &quot;\n*****TASK RESULT*****\n&quot; + &quot;\033[0m\033[0m&quot;)</span><br><span class="line">        print(result)</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def input_keys(self) -&gt; List[str]:</span><br><span class="line">        return [&quot;objective&quot;]</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def output_keys(self) -&gt; List[str]:</span><br><span class="line">        return []</span><br><span class="line"></span><br><span class="line">    def _call(self, inputs: Dict[str, Any]) -&gt; Dict[str, Any]:</span><br><span class="line">        &quot;&quot;&quot;Run the agent.&quot;&quot;&quot;</span><br><span class="line">        objective = inputs[&quot;objective&quot;]</span><br><span class="line">        first_task = inputs.get(&quot;first_task&quot;, &quot;Make a todo list&quot;)</span><br><span class="line">        self.add_task(&#123;&quot;task_id&quot;: 1, &quot;task_name&quot;: first_task&#125;)</span><br><span class="line">        num_iters = 0</span><br><span class="line">        while True:</span><br><span class="line">            if self.task_list:</span><br><span class="line">                self.print_task_list()</span><br><span class="line"></span><br><span class="line">                # Step 1: Pull the first task</span><br><span class="line">                task = self.task_list.popleft()</span><br><span class="line">                self.print_next_task(task)</span><br><span class="line"></span><br><span class="line">                # Step 2: Execute the task</span><br><span class="line">                result = execute_task(</span><br><span class="line">                    self.vectorstore, self.execution_chain, objective, task[&quot;task_name&quot;]</span><br><span class="line">                )</span><br><span class="line">                this_task_id = int(task[&quot;task_id&quot;])</span><br><span class="line">                self.print_task_result(result)</span><br><span class="line"></span><br><span class="line">                # Step 3: Store the result in Pinecone</span><br><span class="line">                result_id = f&quot;result_&#123;task[&#x27;task_id&#x27;]&#125;_&#123;num_iters&#125;&quot;</span><br><span class="line">                self.vectorstore.add_texts(</span><br><span class="line">                    texts=[result],</span><br><span class="line">                    metadatas=[&#123;&quot;task&quot;: task[&quot;task_name&quot;]&#125;],</span><br><span class="line">                    ids=[result_id],</span><br><span class="line">                )</span><br><span class="line"></span><br><span class="line">                # Step 4: Create new tasks and reprioritize task list</span><br><span class="line">                new_tasks = get_next_task(</span><br><span class="line">                    self.task_creation_chain,</span><br><span class="line">                    result,</span><br><span class="line">                    task[&quot;task_name&quot;],</span><br><span class="line">                    [t[&quot;task_name&quot;] for t in self.task_list],</span><br><span class="line">                    objective,</span><br><span class="line">                )</span><br><span class="line">                for new_task in new_tasks:</span><br><span class="line">                    self.task_id_counter += 1</span><br><span class="line">                    new_task.update(&#123;&quot;task_id&quot;: self.task_id_counter&#125;)</span><br><span class="line">                    self.add_task(new_task)</span><br><span class="line">                self.task_list = deque(</span><br><span class="line">                    prioritize_tasks(</span><br><span class="line">                        self.task_prioritization_chain,</span><br><span class="line">                        this_task_id,</span><br><span class="line">                        list(self.task_list),</span><br><span class="line">                        objective,</span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            num_iters += 1</span><br><span class="line">            if self.max_iterations is not None and num_iters == self.max_iterations:</span><br><span class="line">                print(</span><br><span class="line">                    &quot;\033[91m\033[1m&quot; + &quot;\n*****TASK ENDING*****\n&quot; + &quot;\033[0m\033[0m&quot;</span><br><span class="line">                )</span><br><span class="line">                break</span><br><span class="line">        return &#123;&#125;</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def from_llm(</span><br><span class="line">        cls, llm: BaseLLM, vectorstore: VectorStore, verbose: bool = False, **kwargs</span><br><span class="line">    ) -&gt; &quot;BabyAGI&quot;:</span><br><span class="line">        &quot;&quot;&quot;Initialize the BabyAGI Controller.&quot;&quot;&quot;</span><br><span class="line">        task_creation_chain = TaskCreationChain.from_llm(llm, verbose=verbose)</span><br><span class="line">        task_prioritization_chain = TaskPrioritizationChain.from_llm(</span><br><span class="line">            llm, verbose=verbose</span><br><span class="line">        )</span><br><span class="line">        execution_chain = ExecutionChain.from_llm(llm, verbose=verbose)</span><br><span class="line">        return cls(</span><br><span class="line">            task_creation_chain=task_creation_chain,</span><br><span class="line">            task_prioritization_chain=task_prioritization_chain,</span><br><span class="line">            execution_chain=execution_chain,</span><br><span class="line">            vectorstore=vectorstore,</span><br><span class="line">            **kwargs,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>主执行部分，这是代码的入口点，定义了一个目标（分析北京市今天的气候情况，并提出鲜花储存策略），然后初始化并运行 BabyAGI。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 主执行部分</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    OBJECTIVE = &quot;分析一下北京市今天的气候情况，写出鲜花储存策略。&quot;</span><br><span class="line">    llm = OpenAI(temperature=0)</span><br><span class="line">    verbose = False</span><br><span class="line">    max_iterations: Optional[int] = 6</span><br><span class="line">    baby_agi = BabyAGI.from_llm(llm=llm, vectorstore=vectorstore, </span><br><span class="line">                                verbose=verbose, </span><br><span class="line">                                max_iterations=max_iterations)</span><br><span class="line">    baby_agi(&#123;&quot;objective&quot;: OBJECTIVE&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行这个程序之后，产生了下面的结果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">1: Make a todo list</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">1: Make a todo list</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1. Gather data on current weather conditions in Beijing, including temperature, humidity, wind speed, and precipitation.</span><br><span class="line"></span><br><span class="line">2. Analyze the data to determine the best storage strategy for flowers.</span><br><span class="line"></span><br><span class="line">3. Research the optimal temperature, humidity, and other environmental conditions for flower storage.</span><br><span class="line"></span><br><span class="line">4. Develop a plan for storing flowers in Beijing based on the data and research.</span><br><span class="line"></span><br><span class="line">5. Implement the plan and monitor the flowers for any changes in condition.</span><br><span class="line"></span><br><span class="line">6. Make adjustments to the plan as needed.</span><br><span class="line"></span><br><span class="line">*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">2: Identify the most suitable materials for flower storage in Beijing.</span><br><span class="line">3: Investigate the effects of temperature, humidity, and other environmental factors on flower storage.</span><br><span class="line">4: Research the best methods for preserving flowers in Beijing.</span><br><span class="line">5: Develop a plan for storing flowers in Beijing that takes into account the data and research.</span><br><span class="line">6: Monitor the flowers for any changes in condition and make adjustments to the plan as needed.</span><br><span class="line">7: Analyze the current climate conditions in Beijing and write out a strategy for flower storage.</span><br><span class="line">8: Create a report summarizing the findings and recommendations for flower storage in Beijing.</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">2: Identify the most suitable materials for flower storage in Beijing.</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In order to store flowers in Beijing, it is important to consider the current weather conditions. Today, the temperature in Beijing is around 18°C with a humidity of around 70%. This means that the air is relatively dry and cool, making it suitable for storing flowers.</span><br><span class="line"></span><br><span class="line">The best materials for flower storage in Beijing would be materials that are breathable and moisture-resistant. Examples of suitable materials include paper, cardboard, and fabric. These materials will help to keep the flowers fresh and prevent them from wilting. Additionally, it is important to keep the flowers away from direct sunlight and heat sources, as this can cause them to dry out quickly.</span><br><span class="line"></span><br><span class="line">*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">3: Analyze the current climate conditions in Beijing and write out a strategy for flower storage.</span><br><span class="line">4: Investigate the effects of temperature, humidity, and other environmental factors on flower storage in Beijing.</span><br><span class="line">5: Research the best methods for preserving flowers in Beijing.</span><br><span class="line">6: Develop a plan for storing flowers in Beijing that takes into account the data and research.</span><br><span class="line">7: Monitor the flowers for any changes in condition and make adjustments to the plan as needed.</span><br><span class="line">8: Create a report summarizing the findings and recommendations for flower storage in Beijing, and provide suggestions for improvement.</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">3: Analyze the current climate conditions in Beijing and write out a strategy for flower storage.</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Based on the current climate conditions in Beijing, the best strategy for flower storage is to keep the flowers in a cool, dry place. This means avoiding direct sunlight and keeping the flowers away from any sources of heat. Additionally, it is important to keep the flowers away from any sources of moisture, such as humidifiers or air conditioners. The flowers should also be kept away from any sources of strong odors, such as perfumes or cleaning products. Finally, it is important to keep the flowers away from any sources of pests, such as insects or rodents. To ensure the flowers remain in optimal condition, it is important to regularly check the temperature and humidity levels in the storage area.</span><br><span class="line"></span><br><span class="line">*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">4: Monitor the flowers for any changes in condition and make adjustments to the plan as needed.</span><br><span class="line">1: Analyze the impact of different types of flowers on flower storage in Beijing.</span><br><span class="line">2: Compare the effectiveness of different flower storage strategies in Beijing.</span><br><span class="line">3: Investigate the effects of temperature, humidity, and other environmental factors on flower storage in Beijing.</span><br><span class="line">5: Research the best methods for preserving flowers in Beijing.</span><br><span class="line">6: Develop a plan for storing flowers in Beijing that takes into account the data and research.</span><br><span class="line">7: Investigate the effects of different storage materials on flower preservation in Beijing.</span><br><span class="line">8: Develop a system for monitoring the condition of flowers in storage in Beijing.</span><br><span class="line">9: Create a checklist for flower storage in Beijing that can be used to ensure optimal conditions.</span><br><span class="line">10: Identify potential risks associated with flower storage in Beijing and develop strategies to mitigate them.</span><br><span class="line">11: Create a report summarizing the findings and recommendations for flower storage in Beijing, and provide suggestions for improvement.</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">4: Monitor the flowers for any changes in condition and make adjustments to the plan as needed.</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">I will monitor the flowers for any changes in condition and make adjustments to the plan as needed. This includes checking for signs of wilting, discoloration, or other signs of deterioration. I will also monitor the temperature and humidity levels in the storage area to ensure that the flowers are kept in optimal conditions. If necessary, I will adjust the storage plan to ensure that the flowers remain in good condition. Additionally, I will keep track of the expiration date of the flowers and adjust the storage plan accordingly.</span><br><span class="line"></span><br><span class="line">*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">5: Analyze the current climate conditions in Beijing and how they affect flower storage.</span><br><span class="line">6: Investigate the effects of different storage containers on flower preservation in Beijing.</span><br><span class="line">7: Develop a system for tracking the condition of flowers in storage in Beijing.</span><br><span class="line">8: Identify potential pests and diseases that could affect flower storage in Beijing and develop strategies to prevent them.</span><br><span class="line">9: Create a report summarizing the findings and recommendations for flower storage in Beijing, and provide suggestions for improvement.</span><br><span class="line">10: Develop a plan for storing flowers in Beijing that takes into account the data and research.</span><br><span class="line">11: Compare the cost-effectiveness of different flower storage strategies in Beijing.</span><br><span class="line">12: Research the best methods for preserving flowers in Beijing in different seasons.</span><br><span class="line">13: Investigate the effects of temperature, humidity, and other environmental factors on flower storage in Beijing.</span><br><span class="line">14: Investigate the effects of different storage materials on flower preservation in Beijing.</span><br><span class="line">15: Analyze the impact of different types of flowers on flower storage in Beijing.</span><br><span class="line">16: Compare the effectiveness of different flower storage strategies in Beijing.</span><br><span class="line">17: Create a checklist for flower storage in Beijing that can be used to ensure optimal conditions.</span><br><span class="line">18: Identify potential risks associated with flower storage in</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">5: Analyze the current climate conditions in Beijing and how they affect flower storage.</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Based on the current climate conditions in Beijing, the most suitable materials for flower storage would be materials that are breathable and moisture-resistant. This would include materials such as burlap, cotton, and linen. Additionally, it is important to ensure that the flowers are stored in a cool, dry place, away from direct sunlight. Furthermore, it is important to monitor the flowers for any changes in condition and make adjustments to the plan as needed. Finally, it is important to make a to-do list to ensure that all necessary steps are taken to properly store the flowers.</span><br><span class="line"></span><br><span class="line">*****TASK LIST*****</span><br><span class="line"></span><br><span class="line">6: Develop a plan for storing flowers in Beijing that takes into account the local climate conditions.</span><br><span class="line">1: Investigate the effects of different storage containers on flower preservation in Beijing.</span><br><span class="line">2: Investigate the effects of different storage materials on flower preservation in Beijing in different seasons.</span><br><span class="line">3: Analyze the impact of different types of flowers on flower storage in Beijing.</span><br><span class="line">4: Compare the cost-effectiveness of different flower storage strategies in Beijing.</span><br><span class="line">5: Research the best methods for preserving flowers in Beijing in different weather conditions.</span><br><span class="line">7: Develop a system for tracking the condition of flowers in storage in Beijing.</span><br><span class="line">8: Identify potential pests and diseases that could affect flower storage in Beijing and develop strategies to prevent them.</span><br><span class="line">9: Create a report summarizing the findings and recommendations for flower storage in Beijing, and provide suggestions for improvement.</span><br><span class="line">10: Create a checklist for flower storage in Beijing that can be used to ensure optimal conditions.</span><br><span class="line">11: Identify potential risks associated with flower storage in Beijing.</span><br><span class="line"></span><br><span class="line">*****NEXT TASK*****</span><br><span class="line"></span><br><span class="line">6: Develop a plan for storing flowers in Beijing that takes into account the local climate conditions.</span><br><span class="line"></span><br><span class="line">*****TASK RESULT*****</span><br><span class="line">Based on the previously completed tasks, I have developed a plan for storing flowers in Beijing that takes into account the local climate conditions. </span><br><span class="line"></span><br><span class="line">First, I will analyze the current climate conditions in Beijing, including temperature, humidity, and air quality. This will help me identify the most suitable materials for flower storage in Beijing. </span><br><span class="line"></span><br><span class="line">Second, I will create a to-do list of tasks that need to be completed in order to properly store the flowers. This list should include tasks such as selecting the right materials for flower storage, ensuring the flowers are kept in a cool and dry environment, and regularly monitoring the flowers for any changes in condition. </span><br><span class="line"></span><br><span class="line">Third, I will develop a strategy for flower storage that takes into account the local climate conditions. This strategy should include steps such as selecting the right materials for flower storage, ensuring the flowers are kept in a cool and dry environment, and regularly monitoring the flowers for any changes in condition. </span><br><span class="line"></span><br><span class="line">Finally, I will monitor the flowers for any changes in condition and make adjustments to the plan as needed. This will help ensure that the flowers are stored in the most suitable environment for their preservation.</span><br><span class="line"></span><br><span class="line">*****TASK ENDING*****&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>从结构上看，内容以循环方式进行组织，首先是 TASK LIST（任务列表），接着是 NEXT TASK（下一个任务），然后是 TASK RESULT（任务结果）。</p>
<p>每个任务结果似乎都是基于前一个任务的输出。随着自主代理思考的逐步深入，子任务的重点从获取当前的天气数据，到确定最佳的花朵储存策略，再到对策略的实际执行和调整。</p>
<p>6 轮循环之后，在任务的最终结果部分提供了具体的步骤和策略，以确保花朵在最佳的条件下储存。至于这个策略有多大用途，就仁者见仁智者见智了吧。</p>
<h2 id="总结时刻">总结时刻</h2>
<p>模拟代理主要关注模拟特定环境中的行为，而自主代理则更加关注独立性、自适应性和长期的任务执行。</p>
<p>本节课中我们介绍的 Auto-GPT、BabyAGI 以及 HuggingGPT，它们作为自主代理（Autonomous Agents）的代表，旨在创建更加普适和强大的算法，这些算法能够处理各种任务，并在没有明确编程指令的情况下自我改进。</p>
<p>这些自主代理的特点，我列表总结如下，供你参考。</p>
<p><img src="https://static001.geekbang.org/resource/image/56/d1/56d4bdbcaec0deba243a4d7cf6eb71d1.jpg?wh=1482x666" alt=""></p>
<p>未来，这种自主代理将在企业运营的任务分配、项目管理和资源调度等环节中起到至关重要的作用。想象一下，随着人工智能技术的飞速发展，会有众多的自主趋动型的应用程序被开发出来，优化任务管理，AI 将涵盖从项目开始到结束的整个过程，确保每个任务都得到有效的监控和组织。</p>
<h2 id="思考题">思考题</h2>
<ol>
<li class="lvl-4">
<p>请你阅读 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSignificant-Gravitas%2FAutoGPT" title="https://github.com/Significant-Gravitas/AutoGPT">AutoGPT</a> 的细节，并构造自己的 AI 代理。</p>
</li>
<li class="lvl-4">
<p>请你阅读 <a href="https://link.juejin.cn/?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2303.17580.pdf" title="https://arxiv.org/pdf/2303.17580.pdf">HuggingGPT</a> 的细节，并构造自己的 AI 代理。</p>
</li>
</ol>
<p>期待在留言区看到你的分享，如果觉得内容对你有帮助，也欢迎分享给有需要的朋友！最后如果你学有余力，可以进一步学习下面的延伸阅读。</p>
<h2 id="延伸阅读">延伸阅读</h2>
<ol>
<li class="lvl-4">
<p>GitHub 项目 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FSignificant-Gravitas%2FAutoGPT" title="https://github.com/Significant-Gravitas/AutoGPT">AutoGPT</a> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fautogpt.net%2F" title="https://autogpt.net/">官网</a></p>
</li>
<li class="lvl-4">
<p>GitHub 项目 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoheinakajima%2Fbabyagi" title="https://github.com/yoheinakajima/babyagi">BabyAGI</a> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fyoheinakajima.com%2Ftask-driven-autonomous-agent-utilizing-gpt-4-pinecone-and-langchain-for-diverse-applications%2F" title="https://yoheinakajima.com/task-driven-autonomous-agent-utilizing-gpt-4-pinecone-and-langchain-for-diverse-applications/">官网</a></p>
</li>
<li class="lvl-4">
<p>论文 <a href="https://link.juejin.cn/?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2303.17580.pdf" title="https://arxiv.org/pdf/2303.17580.pdf">HuggingGPT: Solving AI Tasks with ChatGPT and its Friends in Hugging Face</a> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fhuggingface.co%2Fspaces%2Fmicrosoft%2FHuggingGPT" title="https://huggingface.co/spaces/microsoft/HuggingGPT">官网</a></p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86%E6%A8%A1%E5%BC%8F%E6%80%9D%E8%80%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86%E6%A8%A1%E5%BC%8F%E6%80%9D%E8%80%83/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-25 16:09:23" itemprop="dateModified" datetime="2024-11-25T16:09:23+08:00">2024-11-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>对每个出现在 [[TODO]] 中的待办规定执行时间，并在执行时严格计时 (可以使用 番茄时钟 计时)</p>
<p>对于可能会有事情打断任务进行，将采取不同解决方案：</p>
<ol>
<li class="lvl-3">
<p>在 3 分钟能解决的突发事件，马上去做，并在之后尽量避免该类情况发生</p>
</li>
<li class="lvl-3">
<p>在 3 分钟内做不完，但并不紧急的，生成待办，放入待整理项里</p>
</li>
<li class="lvl-3">
<p>在 3 分钟内做不完而且紧急的，暂停手头工作，记录工作进度 (以便日后接着干)，然后先解决重要的。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>asdfsadf<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"> <a href="#fnref1" class="footnote-backref">↩︎</a></li>
</ol>
</section>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E6%A8%A1%E6%9D%BF/%F0%9F%93%8B%E6%97%A5%E8%AE%B0%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E6%A8%A1%E6%9D%BF/%F0%9F%93%8B%E6%97%A5%E8%AE%B0%E6%A8%A1%E6%9D%BF/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 22:56:23" itemprop="dateModified" datetime="2024-11-13T22:56:23+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Day planner</h1>
<ul class="lvl-0">
<li class="lvl-2"><input type="checkbox" id="checkbox33"><label for="checkbox33">英语单词</label></li>
</ul>
<h1>今日总结</h1>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E6%A8%A1%E6%9D%BF/%E7%81%B5%E6%84%9F%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E6%A8%A1%E6%9D%BF/%E7%81%B5%E6%84%9F%E6%A8%A1%E6%9D%BF/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 22:56:22" itemprop="dateModified" datetime="2024-11-13T22:56:22+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%81%B5%E6%84%9F/%E7%81%B5%E6%84%9Fmemo/%E6%8F%90%E4%BE%9B%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E7%9A%84%E8%AE%B0%E8%B4%A6%E8%BD%AF%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%81%B5%E6%84%9F/%E7%81%B5%E6%84%9Fmemo/%E6%8F%90%E4%BE%9B%E6%94%AF%E6%8C%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E7%9A%84%E8%AE%B0%E8%B4%A6%E8%BD%AF%E4%BB%B6/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 22:56:26" itemprop="dateModified" datetime="2024-11-13T22:56:26+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>描述：通过 vue 架构，并通过组件式开发，同时将软件中的部分数据接口开发，允许用户调用系统变量，如各种金额的统计信息，并提供各种函数用于数据处理</p>
<blockquote>
<p>[! tip] ins<br>
提供支持自定义内容的记账软件<br>
#灵感 2024/7/17</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/08/%E7%81%B5%E6%84%9F/%E7%81%B5%E6%84%9Fmemo/ttt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="听">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="O3xiaoyuhe">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/08/%E7%81%B5%E6%84%9F/%E7%81%B5%E6%84%9Fmemo/ttt/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-08 20:29:01" itemprop="dateCreated datePublished" datetime="2024-12-08T20:29:01+08:00">2024-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-13 22:56:25" itemprop="dateModified" datetime="2024-11-13T22:56:25+08:00">2024-11-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>[! tip] ins<br>
aaa<br>
#灵感 2024/7/17</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/64/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/64/">64</a><span class="page-number current">65</span><a class="page-number" href="/page/66/">66</a><a class="extend next" rel="next" href="/page/66/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">听</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">653</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">听</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
